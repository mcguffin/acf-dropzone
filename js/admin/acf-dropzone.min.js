!function(e,o){var s=wp.media.View.extend({tagName:"div",className:"acf-dropzone-info",template:wp.template("acf-dropzone-info")}),t=Backbone.View.extend({tagName:"div",className:"media-progress-bar-box",render:function(){return this.$progress=e("<div />").addClass("media-progress-bar"),this.$label=e("<div />").addClass("media-progress-label"),this.$bar=e("<div />"),this.$el.append(this.$label),this.$progress.append(this.$bar).appendTo(this.$el),this},setLabel:function(e){this.$label.text(e)},setProgress:function(e){return this.$bar.width(e+"%"),this}}),i=wp.media.View.extend({template:wp.template("acf-dropzone-notice"),className:"notice is-dismissible",events:{"click .notice-dismiss":"remove"},render:function(){wp.media.View.prototype.render.apply(this,arguments),this.$el.addClass(this.options.type)}}),d=Backbone.View.extend({initialize:function(){return this.notice=!1,this.progress=!1,this.uploader=new wp.media.view.UploaderWindow({controller:this,uploader:{dropzone:this.el,container:this.el}}),this},render:function(){return e(this.uploader.render().el).appendTo(this.el),this},ready:function(){var t=this;return this.$el.on("drop dragenter dragleave dragover",function(e){e.stopPropagation()}).on("drop",function(e){t.removeNotice()}),this.trigger("activate"),this.uploader.ready(),this.uploader.uploader.uploader.bind("FilesAdded",this.filesAdded,this),this.uploader.uploader.uploader.bind("BeforeUpload",this.fileBeforeUpload,this),this.uploader.uploader.uploader.bind("UploadProgress",this.fileUploadProgress,this),this.uploader.uploader.uploader.bind("FileUploaded",this.fileUploaded,this),this.uploader.uploader.uploader.bind("error",this.fileUploadError,this),this},filesAdded:function(e,t){this.total=t.length,this.done=0},fileBeforeUpload:function(e,t){this.addProgress(),this.progress.setLabel(_.escape(t.name))},fileUploadProgress:function(e,t){this.addProgress(),this.progress.setProgress((100*this.done+t.percent)/this.total)},fileUploaded:function(e,t,i){this.file=t,this.trigger("acf-dropzone-uploaded",t.attachment,this.done),this.done++,this.total===this.done&&this.removeProgress()},fileUploadError:function(e,t){this.done++,this.total===this.done&&this.removeProgress(),this.trigger("acf-dropzone-error",t),this.addNotice({type:"error",bold:_.escape(t.file.name),message:t.message})},addProgress:function(){return this.progress||(this.progress=new t,this.progress.render().$el.appendTo(this.el)),this},removeProgress:function(e){return this.progress&&(this.progress.$el.remove(),this.progress=!1),this},addNotice:function(e){return this.notice=new i(e),this.notice.render(),this.notice.$el.prependTo(this.el),this},removeNotice:function(e){return this.notice&&(this.notice.remove(),this.notice=!1),this}});function r(i){var e,r,t;(i=i).$el.is(".dropzone")&&(r=i.parent(),(e=i.$('[data-uploader="wp"]').get(0))&&(i.$(".hide-if-value>p").contents().filter(function(){return 3==this.nodeType}).remove(),(t=new s).render(),t.$el.prependTo(i.$(".hide-if-value")),(o=new d({el:e})).render(),o.ready(),o.on("acf-dropzone-uploaded",function(e,t){"repeater"===r.get("type")&&0<t?i.append(e,r):i.render(e)})))}function n(t){var e=t.$(".acf-gallery-main").get(0);(t=t).$el.is(".dropzone")&&((o=new d({el:e})).render(),o.ready(),o.on("acf-dropzone-uploaded",function(e){t.appendAttachment(e,"prepend"===t.get("insert")?0:void 0)}))}acf.addAction("ready_field/type=image",r),acf.addAction("ready_field/type=file",r),acf.addAction("ready_field/type=gallery",n),acf.addAction("append_field/type=image",r),acf.addAction("append_field/type=file",r),acf.addAction("append_field/type=gallery",n)}(jQuery,acf_dropzone);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjZi1kcm9wem9uZS5qcyJdLCJuYW1lcyI6WyIkIiwiZHJvcHpvbmUiLCJVcGxvYWRlckluZm8iLCJ3cCIsIm1lZGlhIiwiVmlldyIsImV4dGVuZCIsInRhZ05hbWUiLCJjbGFzc05hbWUiLCJ0ZW1wbGF0ZSIsIlByb2dyZXNzIiwiQmFja2JvbmUiLCJyZW5kZXIiLCJ0aGlzIiwiJHByb2dyZXNzIiwiYWRkQ2xhc3MiLCIkbGFiZWwiLCIkYmFyIiwiJGVsIiwiYXBwZW5kIiwiYXBwZW5kVG8iLCJzZXRMYWJlbCIsImxhYmVsIiwidGV4dCIsInNldFByb2dyZXNzIiwicGVyY2VudCIsIndpZHRoIiwiTm90aWNlIiwiZXZlbnRzIiwiY2xpY2sgLm5vdGljZS1kaXNtaXNzIiwicHJvdG90eXBlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJvcHRpb25zIiwidHlwZSIsIkFDRkRyb3B6b25lIiwiaW5pdGlhbGl6ZSIsIm5vdGljZSIsInByb2dyZXNzIiwidXBsb2FkZXIiLCJ2aWV3IiwiVXBsb2FkZXJXaW5kb3ciLCJjb250cm9sbGVyIiwiZWwiLCJjb250YWluZXIiLCJyZWFkeSIsInNlbGYiLCJvbiIsImUiLCJzdG9wUHJvcGFnYXRpb24iLCJyZW1vdmVOb3RpY2UiLCJ0cmlnZ2VyIiwiYmluZCIsImZpbGVzQWRkZWQiLCJmaWxlQmVmb3JlVXBsb2FkIiwiZmlsZVVwbG9hZFByb2dyZXNzIiwiZmlsZVVwbG9hZGVkIiwiZmlsZVVwbG9hZEVycm9yIiwiZmlsZXMiLCJ0b3RhbCIsImxlbmd0aCIsImRvbmUiLCJmaWxlIiwiYWRkUHJvZ3Jlc3MiLCJfIiwiZXNjYXBlIiwibmFtZSIsInJlc3BvbnNlIiwiYXR0YWNobWVudCIsInJlbW92ZVByb2dyZXNzIiwiZXJyb3IiLCJhZGROb3RpY2UiLCJib2xkIiwibWVzc2FnZSIsInJlbW92ZSIsInByZXBlbmRUbyIsImluaXRGaWxlRHJvcHpvbmUiLCJmaWVsZCIsInBhcmVudCIsImluZm8iLCJpcyIsImdldCIsImNvbnRlbnRzIiwiZmlsdGVyIiwibm9kZVR5cGUiLCJpIiwiaW5pdEdhbGxlcnlEcm9wem9uZSIsImFwcGVuZEF0dGFjaG1lbnQiLCJ1bmRlZmluZWQiLCJhY2YiLCJhZGRBY3Rpb24iLCJqUXVlcnkiLCJhY2ZfZHJvcHpvbmUiXSwibWFwcGluZ3MiOiJDQUFBLFNBQVdBLEVBQUdDLEdBd0JiLElBQUlDLEVBQWVDLEdBQUdDLE1BQU1DLEtBQUtDLE9BQU8sQ0FDdkNDLFFBQVcsTUFDWEMsVUFBVyxvQkFDWEMsU0FBU04sR0FBR00sU0FBUyx1QkFFbEJDLEVBQVdDLFNBQVNOLEtBQUtDLE9BQU8sQ0FDbkNDLFFBQVcsTUFDWEMsVUFBVyx5QkFDWEksT0FBTyxXQVVOLE9BVEFDLEtBQUtDLFVBQVlkLEVBQUUsV0FBV2UsU0FBUyxzQkFDdkNGLEtBQUtHLE9BQVNoQixFQUFFLFdBQVdlLFNBQVMsd0JBQ3BDRixLQUFLSSxLQUFPakIsRUFBRSxXQUNkYSxLQUFLSyxJQUNIQyxPQUFRTixLQUFLRyxRQUNmSCxLQUFLQyxVQUNISyxPQUFRTixLQUFLSSxNQUNiRyxTQUFVUCxLQUFLSyxLQUVWTCxNQUVSUSxTQUFTLFNBQVNDLEdBQ2pCVCxLQUFLRyxPQUFPTyxLQUFLRCxJQUVsQkUsWUFBWSxTQUFVQyxHQUVyQixPQURBWixLQUFLSSxLQUFLUyxNQUFPLEVBQVksS0FDdEJiLFFBR0xjLEVBQVN4QixHQUFHQyxNQUFNQyxLQUFLQyxPQUFPLENBQ2pDRyxTQUFTTixHQUFHTSxTQUFTLHVCQUNyQkQsVUFBVSx3QkFDVm9CLE9BQU8sQ0FDTkMsd0JBQTBCLFVBRTNCakIsT0FBTyxXQUNOVCxHQUFHQyxNQUFNQyxLQUFLeUIsVUFBVWxCLE9BQU9tQixNQUFNbEIsS0FBS21CLFdBRTFDbkIsS0FBS0ssSUFBSUgsU0FBU0YsS0FBS29CLFFBQVFDLFNBSzdCQyxFQUFjeEIsU0FBU04sS0FBS0MsT0FBTyxDQUN0QzhCLFdBQVksV0FXWCxPQVZBdkIsS0FBS3dCLFFBQVMsRUFDZHhCLEtBQUt5QixVQUFXLEVBQ2hCekIsS0FBSzBC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Zm5DLEVBQUtrQyxFQUFNN0UsRUFBRSx3QkFBd0JpRixJQUFJLE1BTXpDSixFQUFNN0UsRUFBRSxvQkFDTmtGLFdBQ0FDLE9BQVEsV0FDUixPQUF3QixHQUFqQnRFLEtBQUt1RSxXQUVaVixVQUVGSyxFQUFPLElBQUk3RSxHQUNOVSxTQUNMbUUsRUFBSzdELElBQUl5RCxVQUFXRSxFQUFNN0UsRUFBRSxvQkFFNUJDLEVBQVcsSUFBSWtDLEVBQVksQ0FDMUJRLEdBQUlBLEtBRUkvQixTQUNUWCxFQUFTNEMsUUFDVDVDLEVBQVM4QyxHQUFHLHdCQUF5QixTQUFVcUIsRUFBWWlCLEdBQzlCLGFBQXZCUCxFQUFPRyxJQUFJLFNBQThCLEVBQUpJLEVBQ3pDUixFQUFNMUQsT0FBUWlELEVBQVlVLEdBRTFCRCxFQUFNakUsT0FBT3dELE9BS2hCLFNBQVNrQixFQUFxQlQsR0FDN0IsSUFBSWxDLEVBQUtrQyxFQUFNN0UsRUFBRSxxQkFBcUJpRixJQUFJLElBQ3pDSixFQUFRQSxHQUVJM0QsSUFBSThELEdBQUcsZ0JBSXBCL0UsRUFBVyxJQUFJa0MsRUFBWSxDQUMxQlEsR0FBSUEsS0FFSS9CLFNBQ1RYLEVBQVM0QyxRQUNUNUMsRUFBUzhDLEdBQUcsd0JBQXlCLFNBQVVxQixHQUU5Q1MsRUFBTVUsaUJBQ0xuQixFQUN3QixZQUF4QlMsRUFBTUksSUFBSSxVQUEwQixPQUFJTyxNQU8zQ0MsSUFBSUMsVUFBVyx5QkFBNEJkLEdBQzNDYSxJQUFJQyxVQUFXLHdCQUE0QmQsR0FDM0NhLElBQUlDLFVBQVcsMkJBQTRCSixHQUczQ0csSUFBSUMsVUFBVywwQkFBNkJkLEdBQzVDYSxJQUFJQyxVQUFXLHlCQUE2QmQsR0FDNUNhLElBQUlDLFVBQVcsNEJBQTZCSixHQWxRN0MsQ0FxUUdLLE9BQVFDIiwiZmlsZSI6ImFjZi1kcm9wem9uZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oICQsIGRyb3B6b25lICl7XG5cdC8vXG5cdC8vIGRyb3B6b25lLkRyb3Bsb2FkZXIgPSB3cC5VcGxvYWRlci5leHRlbmQoe1xuXHQvLyBcdGluaXQ6ICAgICBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvLyBcdGVycm9yOiAgICBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvLyBcdHN1Y2Nlc3M6ICBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvLyBcdGFkZGVkOiAgICBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvLyBcdHByb2dyZXNzOiBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvLyBcdGNvbXBsZXRlOiBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvL1xuXHQvLyB9KTtcblxuXHR2YXIgVXBsb2FkZXJJbmZvID0gd3AubWVkaWEuVmlldy5leHRlbmQoe1xuXHRcdHRhZ05hbWU6ICAgJ2RpdicsXG5cdFx0Y2xhc3NOYW1lOiAnYWNmLWRyb3B6b25lLWluZm8nLFxuXHRcdHRlbXBsYXRlOndwLnRlbXBsYXRlKCdhY2YtZHJvcHpvbmUtaW5mbycpXG5cdH0pO1xuXHR2YXIgUHJvZ3Jlc3MgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG5cdFx0dGFnTmFtZTogICAnZGl2Jyxcblx0XHRjbGFzc05hbWU6ICdtZWRpYS1wcm9ncmVzcy1iYXItYm94Jyxcblx0XHRyZW5kZXI6ZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLiRwcm9ncmVzcyA9ICQoJzxkaXYgLz4nKS5hZGRDbGFzcygnbWVkaWEtcHJvZ3Jlc3MtYmFyJyk7XG5cdFx0XHR0aGlzLiRsYWJlbCA9ICQoJzxkaXYgLz4nKS5hZGRDbGFzcygnbWVkaWEtcHJvZ3Jlc3MtbGFiZWwnKTtcblx0XHRcdHRoaXMuJGJhciA9ICQoJzxkaXYgLz4nKTtcblx0XHRcdHRoaXMuJGVsXG5cdFx0XHRcdC5hcHBlbmQoIHRoaXMuJGxhYmVsICk7XG5cdFx0XHR0aGlzLiRwcm9ncmVzc1xuXHRcdFx0XHQuYXBwZW5kKCB0aGlzLiRiYXIgKVxuXHRcdFx0XHQuYXBwZW5kVG8oIHRoaXMuJGVsICk7XG5cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdFx0c2V0TGFiZWw6ZnVuY3Rpb24obGFiZWwpIHtcblx0XHRcdHRoaXMuJGxhYmVsLnRleHQobGFiZWwpO1xuXHRcdH0sXG5cdFx0c2V0UHJvZ3Jlc3M6ZnVuY3Rpb24oIHBlcmNlbnQgKSB7XG5cdFx0XHR0aGlzLiRiYXIud2lkdGgoICggcGVyY2VudCApKyclJyk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdH0pO1xuXHR2YXIgTm90aWNlID0gd3AubWVkaWEuVmlldy5leHRlbmQoe1xuXHRcdHRlbXBsYXRlOndwLnRlbXBsYXRlKCdhY2YtZHJvcHpvbmUtbm90aWNlJyksXG5cdFx0Y2xhc3NOYW1lOidub3RpY2UgaXMtZGlzbWlzc2libGUnLFxuXHRcdGV2ZW50czp7XG5cdFx0XHQnY2xpY2sgLm5vdGljZS1kaXNtaXNzJyA6ICdyZW1vdmUnLFxuXHRcdH0sXG5cdFx0cmVuZGVyOmZ1bmN0aW9uKCkge1xuXHRcdFx0d3AubWVkaWEuVmlldy5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtcblxuXHRcdFx0dGhpcy4kZWwuYWRkQ2xhc3ModGhpcy5vcHRpb25zLnR5cGUpO1xuXHRcdH1cblx0fSlcblxuXG5cdHZhciBBQ0ZEcm9wem9uZSA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblx0XHRpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMubm90aWNlID0gZmFsc2U7XG5cdFx0XHR0aGlzLnByb2dyZXNzID0gZmFsc2U7XG5cdFx0XHR0aGlzLnVwbG9hZGVyID0gbmV3IHdwLm1lZGlhLnZpZXcuVXBsb2FkZXJXaW5kb3coe1xuXHRcdFx0XHRjb250cm9sbGVyOiB0aGlzLFxuXHRcdFx0XHR1cGxvYWRlcjoge1xuXHRcdFx0XHRcdGRyb3B6b25lOiAgdGhpcy5lbCxcblx0XHRcdFx0XHRjb250YWluZXI6IHRoaXMuZWwsXG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHJlbmRlcjpmdW5jdGlvbigpIHtcblx0XHRcdCQoIHRoaXMudXBsb2FkZXIucmVuZGVyKCkuZWwgKS5hcHBlbmRUbyggdGhpcy5lbCApO1xuXG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHJlYWR5OiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHRoaXMuJGVsXG5cdFx0XHQub24oJ2Ryb3AgZHJhZ2VudGVyIGRyYWdsZWF2ZSBkcmFnb3ZlcicsZnVuY3Rpb24oZSl7XG5cdFx0XHRcdC8vIHByZXZlbnQgYmxvY2sgZWRpdG9yIGZpbGUgZHJvcFxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpXG5cdFx0XHR9KVxuXHRcdFx0Lm9uKCdkcm9wJyxmdW5jdGlvbihlKXtcblx0XHRcdFx0Ly8gcmVzZXQgZXJyb3Jcblx0XHRcdFx0c2VsZi5yZW1vdmVOb3RpY2UoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLnRyaWdnZXIoJ2FjdGl2YXRlJylcblx0XHRcdHRoaXMudXBsb2FkZXIucmVhZHkoKTtcblx0XHRcdC8vXG5cdFx0XHR0aGlzLnVwbG9hZGVyLnVwbG9hZGVyLnVwbG9hZGVyLmJpbmQoJ0ZpbGVzQWRkZWQnLCB0aGlzLmZpbGVzQWRkZWQsIHRoaXMgKTtcblx0XHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnQmVmb3JlVXBsb2FkJywgdGhpcy5maWxlQmVmb3JlVXBsb2FkLCB0aGlzICk7XG5cdFx0XHR0aGlzLnVwbG9hZGVyLnVwbG9hZGVyLnVwbG9hZGVyLmJpbmQoJ1VwbG9hZFByb2dyZXNzJywgdGhpcy5maWxlVXBsb2FkUHJvZ3Jlc3MsIHRoaXMgKTtcblx0XHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnRmlsZVVwbG9hZGVkJywgdGhpcy5maWxlVXBsb2FkZWQsIHRoaXMgKTtcblx0XHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnZXJyb3InLCB0aGlzLmZpbGVVcGxvYWRFcnJvciwgdGhpcyApO1xuXG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdGZpbGVzQWRkZWQ6IGZ1bmN0aW9uKCB1cGxvYWRlciwgZmlsZXMgKSB7XG5cdFx0XHQvL1xuXHRcdFx0dGhpcy50b3RhbCA9IGZpbGVzLmxlbmd0aDtcblx0XHRcdHRoaXMuZG9uZSA9IDA7XG5cdFx0XHQvL3RoaXMubm90aWNlID0gZmFsc2U7XG5cdFx0fSxcblx0XHRmaWxlQmVmb3JlVXBsb2FkOiBmdW5jdGlvbiggdXBsb2FkZXIsIGZpbGUgKSB7XG5cdFx0XHR0aGlzLmFkZFByb2dyZXNzKCk7XG5cdFx0XHR0aGlzLnByb2dyZXNzLnNldExhYmVsKCBfLmVzY2FwZShmaWxlLm5hbWUpICk7XG5cdFx0fSxcblx0XHRmaWxlVXBsb2FkUHJvZ3Jlc3M6ZnVuY3Rpb24oIHVwbG9hZGVyLCBmaWxlICkge1xuXHRcdFx0dGhpcy5hZGRQcm9ncmVzcygpO1xuXHRcdFx0dGhpcy5wcm9ncmVzcy5zZXRQcm9ncmVzcyggKCAxMDAgKiB0aGlzLmRvbmUgKyBmaWxlLnBlcmNlbnQgKSAvIHRoaXMudG90YWwgKTtcblx0XHR9LFxuXHRcdGZpbGVVcGxvYWRlZDpmdW5jdGlvbiggdXBsb2FkZXIsIGZpbGUsIHJlc3BvbnNlICkge1xuXHRcdFx0dGhpcy5maWxlID0gZmlsZTtcblx0XHRcdHRoaXMudHJpZ2dlcignYWNmLWRyb3B6b25lLXVwbG9hZGVkJyxmaWxlLmF0dGFjaG1lbnQsdGhpcy5kb25lKTtcblx0XHRcdHRoaXMuZG9uZSsrO1xuXHRcdFx0aWYgKHRoaXMudG90YWwgPT09IHRoaXMuZG9uZSApIHtcblx0XHRcdFx0dGhpcy5yZW1vdmVQcm9ncmVzcygpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0ZmlsZVVwbG9hZEVycm9yOmZ1bmN0aW9uKCB1cGxvYWRlciwgZXJyb3IgKSB7XG5cdFx0XHR0aGlzLmRvbmUrKztcblx0XHRcdGlmICh0aGlzLnRvdGFsID09PSB0aGlzLmRvbmUgKSB7XG5cdFx0XHRcdHRoaXMucmVtb3ZlUHJvZ3Jlc3MoKTtcblx0XHRcdH1cblx0XHRcdHRoaXMudHJpZ2dlciggJ2FjZi1kcm9wem9uZS1lcnJvcicsIGVycm9yICk7XG5cblx0XHRcdHRoaXMuYWRkTm90aWNlKHtcblx0XHRcdFx0dHlwZTonZXJyb3InLFxuXHRcdFx0XHRib2xkOiBfLmVzY2FwZShlcnJvci5maWxlLm5hbWUpLFxuXHRcdFx0XHRtZXNzYWdlOiBlcnJvci5tZXNzYWdlXG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdGFkZFByb2dyZXNzOmZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCB0aGlzLnByb2dyZXNzICkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH1cblx0XHRcdHRoaXMucHJvZ3Jlc3MgPSBuZXcgUHJvZ3Jlc3MoKTtcblx0XHRcdHRoaXMucHJvZ3Jlc3MucmVuZGVyKCkuJGVsLmFwcGVuZFRvKHRoaXMuZWwpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRyZW1vdmVQcm9ncmVzczpmdW5jdGlvbiggcGVyY2VudCApIHtcblx0XHRcdGlmICggISB0aGlzLnByb2dyZXNzICkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5wcm9ncmVzcy4kZWwucmVtb3ZlKCk7XG5cdFx0XHR0aGlzLnByb2dyZXNzID0gZmFsc2U7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdGFkZE5vdGljZTpmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0XHR0aGlzLm5vdGljZSA9IG5ldyBOb3RpY2Uob3B0aW9ucyk7XG5cdFx0XHR0aGlzLm5vdGljZS5yZW5kZXIoKTtcblx0XHRcdHRoaXMubm90aWNlLiRlbC5wcmVwZW5kVG8odGhpcy5lbCk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHJlbW92ZU5vdGljZTpmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0XHRpZiAoICEhIHRoaXMubm90aWNlICkge1xuXHRcdFx0XHR0aGlzLm5vdGljZS5yZW1vdmUoKTtcblx0XHRcdFx0dGhpcy5ub3RpY2UgPSBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblx0fSk7XG4vKlxuPGRpdiBpZD1cIm1lc3NhZ2VcIiBjbGFzcz1cIm5vdGljZSBpcy1kaXNtaXNzaWJsZVwiPlxuXHQ8cD5tc2c8L3A+XG5cdDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwibm90aWNlLWRpc21pc3NcIj5cblx0XHQ8c3BhbiBjbGFzcz1cInNjcmVlbi1yZWFkZXItdGV4dFwiPkRpc21pc3MgdGhpcyBub3RpY2UuPC9zcGFuPlxuXHQ8L2J1dHRvbj5cbjwvZGl2PlxuKi9cblxuXG5cdGZ1bmN0aW9uIGluaXRGaWxlRHJvcHpvbmUoIGZpZWxkICkge1xuXHRcdHZhciBlbCxcblx0XHRcdGZpZWxkID0gZmllbGQsXG5cdFx0XHRwYXJlbnQsXG5cdFx0XHRpbmZvO1xuXG5cdFx0aWYgKCAhIGZpZWxkLiRlbC5pcygnLmRyb3B6b25lJykgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0cGFyZW50ID0gZmllbGQucGFyZW50KCk7XG5cblx0XHRlbCA9IGZpZWxkLiQoJ1tkYXRhLXVwbG9hZGVyPVwid3BcIl0nKS5nZXQoMClcblxuXHRcdGlmICggISBlbCApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0Ly8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTU3MTA3Ni9yZW1vdmUtdGV4dC13aXRoLWpxdWVyeVxuXHRcdGZpZWxkLiQoJy5oaWRlLWlmLXZhbHVlPnAnKVxuXHRcdFx0LmNvbnRlbnRzKClcblx0XHRcdC5maWx0ZXIoIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5ub2RlVHlwZSA9PSAzOyAvL05vZGUuVEVYVF9OT0RFXG5cdFx0XHR9KVxuXHRcdFx0LnJlbW92ZSgpO1xuXG5cdFx0aW5mbyA9IG5ldyBVcGxvYWRlckluZm8oKTtcblx0XHRpbmZvLnJlbmRlcigpO1xuXHRcdGluZm8uJGVsLnByZXBlbmRUbyggZmllbGQuJCgnLmhpZGUtaWYtdmFsdWUnKSApO1xuXG5cdFx0ZHJvcHpvbmUgPSBuZXcgQUNGRHJvcHpvbmUoe1xuXHRcdFx0ZWw6IGVsLFxuXHRcdH0pO1xuXHRcdGRyb3B6b25lLnJlbmRlcigpO1xuXHRcdGRyb3B6b25lLnJlYWR5KCk7XG5cdFx0ZHJvcHpvbmUub24oJ2FjZi1kcm9wem9uZS11cGxvYWRlZCcsIGZ1bmN0aW9uKCBhdHRhY2htZW50LCBpICl7XG5cdFx0XHRpZiAoIHBhcmVudC5nZXQoJ3R5cGUnKSA9PT0gJ3JlcGVhdGVyJyAmJiBpID4gMCApIHtcblx0XHRcdFx0ZmllbGQuYXBwZW5kKCBhdHRhY2htZW50LCBwYXJlbnQgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZpZWxkLnJlbmRlcihhdHRhY2htZW50KTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIGluaXRHYWxsZXJ5RHJvcHpvbmUoIGZpZWxkICkge1xuXHRcdHZhciBlbCA9IGZpZWxkLiQoJy5hY2YtZ2FsbGVyeS1tYWluJykuZ2V0KDApLFxuXHRcdFx0ZmllbGQgPSBmaWVsZDtcblxuXHRcdGlmICggISBmaWVsZC4kZWwuaXMoJy5kcm9wem9uZScpICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGRyb3B6b25lID0gbmV3IEFDRkRyb3B6b25lKHtcblx0XHRcdGVsOiBlbCxcblx0XHR9KTtcblx0XHRkcm9wem9uZS5yZW5kZXIoKTtcblx0XHRkcm9wem9uZS5yZWFkeSgpO1xuXHRcdGRyb3B6b25lLm9uKCdhY2YtZHJvcHpvbmUtdXBsb2FkZWQnLCBmdW5jdGlvbiggYXR0YWNobWVudCApe1xuXG5cdFx0XHRmaWVsZC5hcHBlbmRBdHRhY2htZW50KFxuXHRcdFx0XHRhdHRhY2htZW50LFxuXHRcdFx0XHRmaWVsZC5nZXQoJ2luc2VydCcpID09PSAncHJlcGVuZCcgPyAwIDogdW5kZWZpbmVkXG5cdFx0XHQpO1xuXG5cdFx0fSk7XG5cdH1cblxuXG5cdGFjZi5hZGRBY3Rpb24oICdyZWFkeV9maWVsZC90eXBlPWltYWdlJywgICBpbml0RmlsZURyb3B6b25lICk7XG5cdGFjZi5hZGRBY3Rpb24oICdyZWFkeV9maWVsZC90eXBlPWZpbGUnLCAgICBpbml0RmlsZURyb3B6b25lICk7XG5cdGFjZi5hZGRBY3Rpb24oICdyZWFkeV9maWVsZC90eXBlPWdhbGxlcnknLCBpbml0R2FsbGVyeURyb3B6b25lICk7XG5cblx0Ly8gY3JlYXRlZCBmcm9tIHJlcGVhdGVyXG5cdGFjZi5hZGRBY3Rpb24oICdhcHBlbmRfZmllbGQvdHlwZT1pbWFnZScsICAgaW5pdEZpbGVEcm9wem9uZSApO1xuXHRhY2YuYWRkQWN0aW9uKCAnYXBwZW5kX2ZpZWxkL3R5cGU9ZmlsZScsICAgIGluaXRGaWxlRHJvcHpvbmUgKTtcblx0YWNmLmFkZEFjdGlvbiggJ2FwcGVuZF9maWVsZC90eXBlPWdhbGxlcnknLCBpbml0R2FsbGVyeURyb3B6b25lICk7XG5cblxufSkoalF1ZXJ5LCBhY2ZfZHJvcHpvbmUgKTtcbiJdfQ==
