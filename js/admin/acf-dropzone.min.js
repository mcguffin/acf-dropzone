!function(e,o){var s=wp.media.View.extend({tagName:"div",className:"acf-dropzone-info",template:wp.template("acf-dropzone-info")}),t=Backbone.View.extend({tagName:"div",className:"media-progress-bar-box",render:function(){return this.$progress=e("<div />").addClass("media-progress-bar"),this.$label=e("<div />").addClass("media-progress-label"),this.$bar=e("<div />"),this.$el.append(this.$label),this.$progress.append(this.$bar).appendTo(this.$el),this},setLabel:function(e){this.$label.text(e)},setProgress:function(e){return this.$bar.width(e+"%"),this}}),i=wp.media.View.extend({template:wp.template("acf-dropzone-notice"),className:"notice is-dismissible",events:{"click .notice-dismiss":"remove"},render:function(){wp.media.View.prototype.render.apply(this,arguments),this.$el.addClass(this.options.type)}}),d=Backbone.View.extend({initialize:function(){return this.notice=!1,this.progress=!1,this.uploader=new wp.media.view.UploaderWindow({controller:this,uploader:{dropzone:this.el,container:this.el}}),this},render:function(){return e(this.uploader.render().el).appendTo(this.el),this},ready:function(){var t=this;return this.$el.on("drop dragenter dragleave dragover",function(e){e.stopPropagation()}).on("drop",function(e){t.removeNotice()}),this.trigger("activate"),this.uploader.ready(),this.uploader.uploader.uploader.bind("FilesAdded",this.filesAdded,this),this.uploader.uploader.uploader.bind("BeforeUpload",this.fileBeforeUpload,this),this.uploader.uploader.uploader.bind("UploadProgress",this.fileUploadProgress,this),this.uploader.uploader.uploader.bind("FileUploaded",this.fileUploaded,this),this.uploader.uploader.uploader.bind("error",this.fileUploadError,this),this},filesAdded:function(e,t){this.total=t.length,this.done=0},fileBeforeUpload:function(e,t){this.addProgress(),this.progress.setLabel(_.escape(t.name))},fileUploadProgress:function(e,t){this.addProgress(),this.progress.setProgress((100*this.done+t.percent)/this.total)},fileUploaded:function(e,t,i){this.file=t,this.trigger("acf-dropzone-uploaded",t.attachment,this.done),this.done++,this.total===this.done&&this.removeProgress()},fileUploadError:function(e,t){this.done++,this.total===this.done&&this.removeProgress(),this.trigger("acf-dropzone-error",t),this.addNotice({type:"error",bold:_.escape(t.file.name),message:t.message})},addProgress:function(){return this.progress||(this.progress=new t,this.progress.render().$el.appendTo(this.el)),this},removeProgress:function(e){return this.progress&&(this.progress.$el.remove(),this.progress=!1),this},addNotice:function(e){return this.notice=new i(e),this.notice.render(),this.notice.$el.prependTo(this.el),this},removeNotice:function(e){return this.notice&&(this.notice.remove(),this.notice=!1),this}});function r(i){var e,r,t;(i=i).$el.is(".dropzone")&&(r=i.parent(),(e=i.$('[data-uploader="wp"]').get(0))&&(i.$(".hide-if-value>p").contents().filter(function(){return 3==this.nodeType}).remove(),(t=new s).render(),t.$el.prependTo(i.$(".hide-if-value")),(o=new d({el:e})).render(),o.ready(),o.on("acf-dropzone-uploaded",function(e,t){r&&"repeater"===r.get("type")&&0<t?i.append(e,r):i.render(e)})))}function n(t){var e=t.$(".acf-gallery-main").get(0);(t=t).$el.is(".dropzone")&&((o=new d({el:e})).render(),o.ready(),o.on("acf-dropzone-uploaded",function(e){t.appendAttachment(e,"prepend"===t.get("insert")?0:void 0)}))}acf.addAction("ready_field/type=image",r),acf.addAction("ready_field/type=file",r),acf.addAction("ready_field/type=gallery",n),acf.addAction("append_field/type=image",r),acf.addAction("append_field/type=file",r),acf.addAction("append_field/type=gallery",n)}(jQuery,acf_dropzone);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjZi1kcm9wem9uZS5qcyJdLCJuYW1lcyI6WyIkIiwiZHJvcHpvbmUiLCJVcGxvYWRlckluZm8iLCJ3cCIsIm1lZGlhIiwiVmlldyIsImV4dGVuZCIsInRhZ05hbWUiLCJjbGFzc05hbWUiLCJ0ZW1wbGF0ZSIsIlByb2dyZXNzIiwiQmFja2JvbmUiLCJyZW5kZXIiLCJ0aGlzIiwiJHByb2dyZXNzIiwiYWRkQ2xhc3MiLCIkbGFiZWwiLCIkYmFyIiwiJGVsIiwiYXBwZW5kIiwiYXBwZW5kVG8iLCJzZXRMYWJlbCIsImxhYmVsIiwidGV4dCIsInNldFByb2dyZXNzIiwicGVyY2VudCIsIndpZHRoIiwiTm90aWNlIiwiZXZlbnRzIiwiY2xpY2sgLm5vdGljZS1kaXNtaXNzIiwicHJvdG90eXBlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJvcHRpb25zIiwidHlwZSIsIkFDRkRyb3B6b25lIiwiaW5pdGlhbGl6ZSIsIm5vdGljZSIsInByb2dyZXNzIiwidXBsb2FkZXIiLCJ2aWV3IiwiVXBsb2FkZXJXaW5kb3ciLCJjb250cm9sbGVyIiwiZWwiLCJjb250YWluZXIiLCJyZWFkeSIsInNlbGYiLCJvbiIsImUiLCJzdG9wUHJvcGFnYXRpb24iLCJyZW1vdmVOb3RpY2UiLCJ0cmlnZ2VyIiwiYmluZCIsImZpbGVzQWRkZWQiLCJmaWxlQmVmb3JlVXBsb2FkIiwiZmlsZVVwbG9hZFByb2dyZXNzIiwiZmlsZVVwbG9hZGVkIiwiZmlsZVVwbG9hZEVycm9yIiwiZmlsZXMiLCJ0b3RhbCIsImxlbmd0aCIsImRvbmUiLCJmaWxlIiwiYWRkUHJvZ3Jlc3MiLCJfIiwiZXNjYXBlIiwibmFtZSIsInJlc3BvbnNlIiwiYXR0YWNobWVudCIsInJlbW92ZVByb2dyZXNzIiwiZXJyb3IiLCJhZGROb3RpY2UiLCJib2xkIiwibWVzc2FnZSIsInJlbW92ZSIsInByZXBlbmRUbyIsImluaXRGaWxlRHJvcHpvbmUiLCJmaWVsZCIsInBhcmVudCIsImluZm8iLCJpcyIsImdldCIsImNvbnRlbnRzIiwiZmlsdGVyIiwibm9kZVR5cGUiLCJpIiwiaW5pdEdhbGxlcnlEcm9wem9uZSIsImFwcGVuZEF0dGFjaG1lbnQiLCJ1bmRlZmluZWQiLCJhY2YiLCJhZGRBY3Rpb24iLCJqUXVlcnkiLCJhY2ZfZHJvcHpvbmUiXSwibWFwcGluZ3MiOiJDQUFBLFNBQVdBLEVBQUdDLEdBd0JiLElBQUlDLEVBQWVDLEdBQUdDLE1BQU1DLEtBQUtDLE9BQU8sQ0FDdkNDLFFBQVcsTUFDWEMsVUFBVyxvQkFDWEMsU0FBU04sR0FBR00sU0FBUyx1QkFFbEJDLEVBQVdDLFNBQVNOLEtBQUtDLE9BQU8sQ0FDbkNDLFFBQVcsTUFDWEMsVUFBVyx5QkFDWEksT0FBTyxXQVVOLE9BVEFDLEtBQUtDLFVBQVlkLEVBQUUsV0FBV2UsU0FBUyxzQkFDdkNGLEtBQUtHLE9BQVNoQixFQUFFLFdBQVdlLFNBQVMsd0JBQ3BDRixLQUFLSSxLQUFPakIsRUFBRSxXQUNkYSxLQUFLSyxJQUNIQyxPQUFRTixLQUFLRyxRQUNmSCxLQUFLQyxVQUNISyxPQUFRTixLQUFLSSxNQUNiRyxTQUFVUCxLQUFLSyxLQUVWTCxNQUVSUSxTQUFTLFNBQVNDLEdBQ2pCVCxLQUFLRyxPQUFPTyxLQUFLRCxJQUVsQkUsWUFBWSxTQUFVQyxHQUVyQixPQURBWixLQUFLSSxLQUFLUyxNQUFPLEVBQVksS0FDdEJiLFFBR0xjLEVBQVN4QixHQUFHQyxNQUFNQyxLQUFLQyxPQUFPLENBQ2pDRyxTQUFTTixHQUFHTSxTQUFTLHVCQUNyQkQsVUFBVSx3QkFDVm9CLE9BQU8sQ0FDTkMsd0JBQTBCLFVBRTNCakIsT0FBTyxXQUNOVCxHQUFHQyxNQUFNQyxLQUFLeUIsVUFBVWxCLE9BQU9tQixNQUFNbEIsS0FBS21CLFdBRTFDbkIsS0FBS0ssSUFBSUgsU0FBU0YsS0FBS29CLFFBQVFDLFNBSzdCQyxFQUFjeEIsU0FBU04sS0FBS0MsT0FBTyxDQUN0QzhCLFdBQVksV0FXWCxPQVZBdkIsS0FBS3dCLFFBQVMsRUFDZHhCLEtBQUt5QixVQUFXLEVBQ2hCekIsS0FBSzBC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Zm5DLEVBQUtrQyxFQUFNN0UsRUFBRSx3QkFBd0JpRixJQUFJLE1BTXpDSixFQUFNN0UsRUFBRSxvQkFDTmtGLFdBQ0FDLE9BQVEsV0FDUixPQUF3QixHQUFqQnRFLEtBQUt1RSxXQUVaVixVQUVGSyxFQUFPLElBQUk3RSxHQUNOVSxTQUNMbUUsRUFBSzdELElBQUl5RCxVQUFXRSxFQUFNN0UsRUFBRSxvQkFFNUJDLEVBQVcsSUFBSWtDLEVBQVksQ0FDMUJRLEdBQUlBLEtBRUkvQixTQUNUWCxFQUFTNEMsUUFDVDVDLEVBQVM4QyxHQUFHLHdCQUF5QixTQUFVcUIsRUFBWWlCLEdBQ3JEUCxHQUFpQyxhQUF2QkEsRUFBT0csSUFBSSxTQUE4QixFQUFKSSxFQUNuRFIsRUFBTTFELE9BQVFpRCxFQUFZVSxHQUUxQkQsRUFBTWpFLE9BQU93RCxPQUtoQixTQUFTa0IsRUFBcUJULEdBQzdCLElBQUlsQyxFQUFLa0MsRUFBTTdFLEVBQUUscUJBQXFCaUYsSUFBSSxJQUN6Q0osRUFBUUEsR0FFSTNELElBQUk4RCxHQUFHLGdCQUlwQi9FLEVBQVcsSUFBSWtDLEVBQVksQ0FDMUJRLEdBQUlBLEtBRUkvQixTQUNUWCxFQUFTNEMsUUFDVDVDLEVBQVM4QyxHQUFHLHdCQUF5QixTQUFVcUIsR0FFOUNTLEVBQU1VLGlCQUNMbkIsRUFDd0IsWUFBeEJTLEVBQU1JLElBQUksVUFBMEIsT0FBSU8sTUFPM0NDLElBQUlDLFVBQVcseUJBQTRCZCxHQUMzQ2EsSUFBSUMsVUFBVyx3QkFBNEJkLEdBQzNDYSxJQUFJQyxVQUFXLDJCQUE0QkosR0FHM0NHLElBQUlDLFVBQVcsMEJBQTZCZCxHQUM1Q2EsSUFBSUMsVUFBVyx5QkFBNkJkLEdBQzVDYSxJQUFJQyxVQUFXLDRCQUE2QkosR0FsUTdDLENBcVFHSyxPQUFRQyIsImZpbGUiOiJhY2YtZHJvcHpvbmUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCAkLCBkcm9wem9uZSApe1xuXHQvL1xuXHQvLyBkcm9wem9uZS5Ecm9wbG9hZGVyID0gd3AuVXBsb2FkZXIuZXh0ZW5kKHtcblx0Ly8gXHRpbml0OiAgICAgZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly8gXHRlcnJvcjogICAgZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly8gXHRzdWNjZXNzOiAgZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly8gXHRhZGRlZDogICAgZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly8gXHRwcm9ncmVzczogZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly8gXHRjb21wbGV0ZTogZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly9cblx0Ly8gfSk7XG5cblx0dmFyIFVwbG9hZGVySW5mbyA9IHdwLm1lZGlhLlZpZXcuZXh0ZW5kKHtcblx0XHR0YWdOYW1lOiAgICdkaXYnLFxuXHRcdGNsYXNzTmFtZTogJ2FjZi1kcm9wem9uZS1pbmZvJyxcblx0XHR0ZW1wbGF0ZTp3cC50ZW1wbGF0ZSgnYWNmLWRyb3B6b25lLWluZm8nKVxuXHR9KTtcblx0dmFyIFByb2dyZXNzID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXHRcdHRhZ05hbWU6ICAgJ2RpdicsXG5cdFx0Y2xhc3NOYW1lOiAnbWVkaWEtcHJvZ3Jlc3MtYmFyLWJveCcsXG5cdFx0cmVuZGVyOmZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy4kcHJvZ3Jlc3MgPSAkKCc8ZGl2IC8+JykuYWRkQ2xhc3MoJ21lZGlhLXByb2dyZXNzLWJhcicpO1xuXHRcdFx0dGhpcy4kbGFiZWwgPSAkKCc8ZGl2IC8+JykuYWRkQ2xhc3MoJ21lZGlhLXByb2dyZXNzLWxhYmVsJyk7XG5cdFx0XHR0aGlzLiRiYXIgPSAkKCc8ZGl2IC8+Jyk7XG5cdFx0XHR0aGlzLiRlbFxuXHRcdFx0XHQuYXBwZW5kKCB0aGlzLiRsYWJlbCApO1xuXHRcdFx0dGhpcy4kcHJvZ3Jlc3Ncblx0XHRcdFx0LmFwcGVuZCggdGhpcy4kYmFyIClcblx0XHRcdFx0LmFwcGVuZFRvKCB0aGlzLiRlbCApO1xuXG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHNldExhYmVsOmZ1bmN0aW9uKGxhYmVsKSB7XG5cdFx0XHR0aGlzLiRsYWJlbC50ZXh0KGxhYmVsKTtcblx0XHR9LFxuXHRcdHNldFByb2dyZXNzOmZ1bmN0aW9uKCBwZXJjZW50ICkge1xuXHRcdFx0dGhpcy4kYmFyLndpZHRoKCAoIHBlcmNlbnQgKSsnJScpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHR9KTtcblx0dmFyIE5vdGljZSA9IHdwLm1lZGlhLlZpZXcuZXh0ZW5kKHtcblx0XHR0ZW1wbGF0ZTp3cC50ZW1wbGF0ZSgnYWNmLWRyb3B6b25lLW5vdGljZScpLFxuXHRcdGNsYXNzTmFtZTonbm90aWNlIGlzLWRpc21pc3NpYmxlJyxcblx0XHRldmVudHM6e1xuXHRcdFx0J2NsaWNrIC5ub3RpY2UtZGlzbWlzcycgOiAncmVtb3ZlJyxcblx0XHR9LFxuXHRcdHJlbmRlcjpmdW5jdGlvbigpIHtcblx0XHRcdHdwLm1lZGlhLlZpZXcucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XG5cblx0XHRcdHRoaXMuJGVsLmFkZENsYXNzKHRoaXMub3B0aW9ucy50eXBlKTtcblx0XHR9XG5cdH0pXG5cblxuXHR2YXIgQUNGRHJvcHpvbmUgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG5cdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLm5vdGljZSA9IGZhbHNlO1xuXHRcdFx0dGhpcy5wcm9ncmVzcyA9IGZhbHNlO1xuXHRcdFx0dGhpcy51cGxvYWRlciA9IG5ldyB3cC5tZWRpYS52aWV3LlVwbG9hZGVyV2luZG93KHtcblx0XHRcdFx0Y29udHJvbGxlcjogdGhpcyxcblx0XHRcdFx0dXBsb2FkZXI6IHtcblx0XHRcdFx0XHRkcm9wem9uZTogIHRoaXMuZWwsXG5cdFx0XHRcdFx0Y29udGFpbmVyOiB0aGlzLmVsLFxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRyZW5kZXI6ZnVuY3Rpb24oKSB7XG5cdFx0XHQkKCB0aGlzLnVwbG9hZGVyLnJlbmRlcigpLmVsICkuYXBwZW5kVG8oIHRoaXMuZWwgKTtcblxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRyZWFkeTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHR0aGlzLiRlbFxuXHRcdFx0Lm9uKCdkcm9wIGRyYWdlbnRlciBkcmFnbGVhdmUgZHJhZ292ZXInLGZ1bmN0aW9uKGUpe1xuXHRcdFx0XHQvLyBwcmV2ZW50IGJsb2NrIGVkaXRvciBmaWxlIGRyb3Bcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKVxuXHRcdFx0fSlcblx0XHRcdC5vbignZHJvcCcsZnVuY3Rpb24oZSl7XG5cdFx0XHRcdC8vIHJlc2V0IGVycm9yXG5cdFx0XHRcdHNlbGYucmVtb3ZlTm90aWNlKCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy50cmlnZ2VyKCdhY3RpdmF0ZScpXG5cdFx0XHR0aGlzLnVwbG9hZGVyLnJlYWR5KCk7XG5cdFx0XHQvL1xuXHRcdFx0dGhpcy51cGxvYWRlci51cGxvYWRlci51cGxvYWRlci5iaW5kKCdGaWxlc0FkZGVkJywgdGhpcy5maWxlc0FkZGVkLCB0aGlzICk7XG5cdFx0XHR0aGlzLnVwbG9hZGVyLnVwbG9hZGVyLnVwbG9hZGVyLmJpbmQoJ0JlZm9yZVVwbG9hZCcsIHRoaXMuZmlsZUJlZm9yZVVwbG9hZCwgdGhpcyApO1xuXHRcdFx0dGhpcy51cGxvYWRlci51cGxvYWRlci51cGxvYWRlci5iaW5kKCdVcGxvYWRQcm9ncmVzcycsIHRoaXMuZmlsZVVwbG9hZFByb2dyZXNzLCB0aGlzICk7XG5cdFx0XHR0aGlzLnVwbG9hZGVyLnVwbG9hZGVyLnVwbG9hZGVyLmJpbmQoJ0ZpbGVVcGxvYWRlZCcsIHRoaXMuZmlsZVVwbG9hZGVkLCB0aGlzICk7XG5cdFx0XHR0aGlzLnVwbG9hZGVyLnVwbG9hZGVyLnVwbG9hZGVyLmJpbmQoJ2Vycm9yJywgdGhpcy5maWxlVXBsb2FkRXJyb3IsIHRoaXMgKTtcblxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRmaWxlc0FkZGVkOiBmdW5jdGlvbiggdXBsb2FkZXIsIGZpbGVzICkge1xuXHRcdFx0Ly9cblx0XHRcdHRoaXMudG90YWwgPSBmaWxlcy5sZW5ndGg7XG5cdFx0XHR0aGlzLmRvbmUgPSAwO1xuXHRcdFx0Ly90aGlzLm5vdGljZSA9IGZhbHNlO1xuXHRcdH0sXG5cdFx0ZmlsZUJlZm9yZVVwbG9hZDogZnVuY3Rpb24oIHVwbG9hZGVyLCBmaWxlICkge1xuXHRcdFx0dGhpcy5hZGRQcm9ncmVzcygpO1xuXHRcdFx0dGhpcy5wcm9ncmVzcy5zZXRMYWJlbCggXy5lc2NhcGUoZmlsZS5uYW1lKSApO1xuXHRcdH0sXG5cdFx0ZmlsZVVwbG9hZFByb2dyZXNzOmZ1bmN0aW9uKCB1cGxvYWRlciwgZmlsZSApIHtcblx0XHRcdHRoaXMuYWRkUHJvZ3Jlc3MoKTtcblx0XHRcdHRoaXMucHJvZ3Jlc3Muc2V0UHJvZ3Jlc3MoICggMTAwICogdGhpcy5kb25lICsgZmlsZS5wZXJjZW50ICkgLyB0aGlzLnRvdGFsICk7XG5cdFx0fSxcblx0XHRmaWxlVXBsb2FkZWQ6ZnVuY3Rpb24oIHVwbG9hZGVyLCBmaWxlLCByZXNwb25zZSApIHtcblx0XHRcdHRoaXMuZmlsZSA9IGZpbGU7XG5cdFx0XHR0aGlzLnRyaWdnZXIoJ2FjZi1kcm9wem9uZS11cGxvYWRlZCcsZmlsZS5hdHRhY2htZW50LHRoaXMuZG9uZSk7XG5cdFx0XHR0aGlzLmRvbmUrKztcblx0XHRcdGlmICh0aGlzLnRvdGFsID09PSB0aGlzLmRvbmUgKSB7XG5cdFx0XHRcdHRoaXMucmVtb3ZlUHJvZ3Jlc3MoKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGZpbGVVcGxvYWRFcnJvcjpmdW5jdGlvbiggdXBsb2FkZXIsIGVycm9yICkge1xuXHRcdFx0dGhpcy5kb25lKys7XG5cdFx0XHRpZiAodGhpcy50b3RhbCA9PT0gdGhpcy5kb25lICkge1xuXHRcdFx0XHR0aGlzLnJlbW92ZVByb2dyZXNzKCk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnRyaWdnZXIoICdhY2YtZHJvcHpvbmUtZXJyb3InLCBlcnJvciApO1xuXG5cdFx0XHR0aGlzLmFkZE5vdGljZSh7XG5cdFx0XHRcdHR5cGU6J2Vycm9yJyxcblx0XHRcdFx0Ym9sZDogXy5lc2NhcGUoZXJyb3IuZmlsZS5uYW1lKSxcblx0XHRcdFx0bWVzc2FnZTogZXJyb3IubWVzc2FnZVxuXHRcdFx0fSk7XG5cdFx0fSxcblx0XHRhZGRQcm9ncmVzczpmdW5jdGlvbigpIHtcblx0XHRcdGlmICggdGhpcy5wcm9ncmVzcyApIHtcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnByb2dyZXNzID0gbmV3IFByb2dyZXNzKCk7XG5cdFx0XHR0aGlzLnByb2dyZXNzLnJlbmRlcigpLiRlbC5hcHBlbmRUbyh0aGlzLmVsKTtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdFx0cmVtb3ZlUHJvZ3Jlc3M6ZnVuY3Rpb24oIHBlcmNlbnQgKSB7XG5cdFx0XHRpZiAoICEgdGhpcy5wcm9ncmVzcyApIHtcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMucHJvZ3Jlc3MuJGVsLnJlbW92ZSgpO1xuXHRcdFx0dGhpcy5wcm9ncmVzcyA9IGZhbHNlO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRhZGROb3RpY2U6ZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdFx0dGhpcy5ub3RpY2UgPSBuZXcgTm90aWNlKG9wdGlvbnMpO1xuXHRcdFx0dGhpcy5ub3RpY2UucmVuZGVyKCk7XG5cdFx0XHR0aGlzLm5vdGljZS4kZWwucHJlcGVuZFRvKHRoaXMuZWwpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRyZW1vdmVOb3RpY2U6ZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdFx0aWYgKCAhISB0aGlzLm5vdGljZSApIHtcblx0XHRcdFx0dGhpcy5ub3RpY2UucmVtb3ZlKCk7XG5cdFx0XHRcdHRoaXMubm90aWNlID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdH0pO1xuLypcbjxkaXYgaWQ9XCJtZXNzYWdlXCIgY2xhc3M9XCJub3RpY2UgaXMtZGlzbWlzc2libGVcIj5cblx0PHA+bXNnPC9wPlxuXHQ8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cIm5vdGljZS1kaXNtaXNzXCI+XG5cdFx0PHNwYW4gY2xhc3M9XCJzY3JlZW4tcmVhZGVyLXRleHRcIj5EaXNtaXNzIHRoaXMgbm90aWNlLjwvc3Bhbj5cblx0PC9idXR0b24+XG48L2Rpdj5cbiovXG5cblxuXHRmdW5jdGlvbiBpbml0RmlsZURyb3B6b25lKCBmaWVsZCApIHtcblx0XHR2YXIgZWwsXG5cdFx0XHRmaWVsZCA9IGZpZWxkLFxuXHRcdFx0cGFyZW50LFxuXHRcdFx0aW5mbztcblxuXHRcdGlmICggISBmaWVsZC4kZWwuaXMoJy5kcm9wem9uZScpICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHBhcmVudCA9IGZpZWxkLnBhcmVudCgpO1xuXG5cdFx0ZWwgPSBmaWVsZC4kKCdbZGF0YS11cGxvYWRlcj1cIndwXCJdJykuZ2V0KDApXG5cblx0XHRpZiAoICEgZWwgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE1NzEwNzYvcmVtb3ZlLXRleHQtd2l0aC1qcXVlcnlcblx0XHRmaWVsZC4kKCcuaGlkZS1pZi12YWx1ZT5wJylcblx0XHRcdC5jb250ZW50cygpXG5cdFx0XHQuZmlsdGVyKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMubm9kZVR5cGUgPT0gMzsgLy9Ob2RlLlRFWFRfTk9ERVxuXHRcdFx0fSlcblx0XHRcdC5yZW1vdmUoKTtcblxuXHRcdGluZm8gPSBuZXcgVXBsb2FkZXJJbmZvKCk7XG5cdFx0aW5mby5yZW5kZXIoKTtcblx0XHRpbmZvLiRlbC5wcmVwZW5kVG8oIGZpZWxkLiQoJy5oaWRlLWlmLXZhbHVlJykgKTtcblxuXHRcdGRyb3B6b25lID0gbmV3IEFDRkRyb3B6b25lKHtcblx0XHRcdGVsOiBlbCxcblx0XHR9KTtcblx0XHRkcm9wem9uZS5yZW5kZXIoKTtcblx0XHRkcm9wem9uZS5yZWFkeSgpO1xuXHRcdGRyb3B6b25lLm9uKCdhY2YtZHJvcHpvbmUtdXBsb2FkZWQnLCBmdW5jdGlvbiggYXR0YWNobWVudCwgaSApe1xuXHRcdFx0aWYgKCBwYXJlbnQgJiYgcGFyZW50LmdldCgndHlwZScpID09PSAncmVwZWF0ZXInICYmIGkgPiAwICkge1xuXHRcdFx0XHRmaWVsZC5hcHBlbmQoIGF0dGFjaG1lbnQsIHBhcmVudCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZmllbGQucmVuZGVyKGF0dGFjaG1lbnQpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gaW5pdEdhbGxlcnlEcm9wem9uZSggZmllbGQgKSB7XG5cdFx0dmFyIGVsID0gZmllbGQuJCgnLmFjZi1nYWxsZXJ5LW1haW4nKS5nZXQoMCksXG5cdFx0XHRmaWVsZCA9IGZpZWxkO1xuXG5cdFx0aWYgKCAhIGZpZWxkLiRlbC5pcygnLmRyb3B6b25lJykgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0ZHJvcHpvbmUgPSBuZXcgQUNGRHJvcHpvbmUoe1xuXHRcdFx0ZWw6IGVsLFxuXHRcdH0pO1xuXHRcdGRyb3B6b25lLnJlbmRlcigpO1xuXHRcdGRyb3B6b25lLnJlYWR5KCk7XG5cdFx0ZHJvcHpvbmUub24oJ2FjZi1kcm9wem9uZS11cGxvYWRlZCcsIGZ1bmN0aW9uKCBhdHRhY2htZW50ICl7XG5cblx0XHRcdGZpZWxkLmFwcGVuZEF0dGFjaG1lbnQoXG5cdFx0XHRcdGF0dGFjaG1lbnQsXG5cdFx0XHRcdGZpZWxkLmdldCgnaW5zZXJ0JykgPT09ICdwcmVwZW5kJyA/IDAgOiB1bmRlZmluZWRcblx0XHRcdCk7XG5cblx0XHR9KTtcblx0fVxuXG5cblx0YWNmLmFkZEFjdGlvbiggJ3JlYWR5X2ZpZWxkL3R5cGU9aW1hZ2UnLCAgIGluaXRGaWxlRHJvcHpvbmUgKTtcblx0YWNmLmFkZEFjdGlvbiggJ3JlYWR5X2ZpZWxkL3R5cGU9ZmlsZScsICAgIGluaXRGaWxlRHJvcHpvbmUgKTtcblx0YWNmLmFkZEFjdGlvbiggJ3JlYWR5X2ZpZWxkL3R5cGU9Z2FsbGVyeScsIGluaXRHYWxsZXJ5RHJvcHpvbmUgKTtcblxuXHQvLyBjcmVhdGVkIGZyb20gcmVwZWF0ZXJcblx0YWNmLmFkZEFjdGlvbiggJ2FwcGVuZF9maWVsZC90eXBlPWltYWdlJywgICBpbml0RmlsZURyb3B6b25lICk7XG5cdGFjZi5hZGRBY3Rpb24oICdhcHBlbmRfZmllbGQvdHlwZT1maWxlJywgICAgaW5pdEZpbGVEcm9wem9uZSApO1xuXHRhY2YuYWRkQWN0aW9uKCAnYXBwZW5kX2ZpZWxkL3R5cGU9Z2FsbGVyeScsIGluaXRHYWxsZXJ5RHJvcHpvbmUgKTtcblxuXG59KShqUXVlcnksIGFjZl9kcm9wem9uZSApO1xuIl19
