!function(e,r){var o=wp.media.View.extend({tagName:"div",className:"acf-dropzone-info",template:wp.template("acf-dropzone-info")}),i=Backbone.View.extend({tagName:"div",className:"media-progress-bar-box",render:function(){return this.$progress=e("<div />").addClass("media-progress-bar"),this.$label=e("<div />").addClass("media-progress-label"),this.$bar=e("<div />"),this.$el.append(this.$label),this.$progress.append(this.$bar).appendTo(this.$el),this},setLabel:function(e){this.$label.text(e)},setProgress:function(e){return this.$bar.width(e+"%"),this}}),t=wp.media.View.extend({template:wp.template("acf-dropzone-notice"),className:"notice is-dismissible",events:{"click .notice-dismiss":"remove"},render:function(){wp.media.View.prototype.render.apply(this,arguments),this.$el.addClass(this.options.type)}}),s=Backbone.View.extend({initialize:function(){return this.notice=!1,this.progress=!1,this.uploader=new wp.media.view.UploaderWindow({controller:this,uploader:{dropzone:this.el,container:this.el}}),this},render:function(){return e(this.uploader.render().el).appendTo(this.el),this},ready:function(){return this.trigger("activate"),this.uploader.ready(),this.uploader.uploader.uploader.bind("FilesAdded",this.filesAdded,this),this.uploader.uploader.uploader.bind("BeforeUpload",this.fileBeforeUpload,this),this.uploader.uploader.uploader.bind("UploadProgress",this.fileUploadProgress,this),this.uploader.uploader.uploader.bind("FileUploaded",this.fileUploaded,this),this.uploader.uploader.uploader.bind("error",this.fileUploadError,this),this},filesAdded:function(e,i){this.total=i.length,this.done=0},fileBeforeUpload:function(e,i){this.notice&&this.notice.remove(),this.addProgress(),this.progress.setLabel(_.escape(i.name)),this.notice=!1},fileUploadProgress:function(e,i){this.addProgress(),this.progress.setProgress((100*this.done+i.percent)/this.total)},fileUploaded:function(e,i,t){this.done++,this.file=i,this.removeProgress(),this.trigger("acf-dropzone-uploaded",i.attachment)},fileUploadError:function(e,i){this.done++,this.removeProgress(),this.trigger("acf-dropzone-error",i),this.notice=new t({type:"error",bold:_.escape(i.file.name),message:i.message}),this.notice.render(),this.notice.$el.prependTo(this.el),this.total--},addProgress:function(){if(this.progress)return this;this.progress=new i,this.progress.render().$el.appendTo(this.el)},removeProgress:function(e){return this.progress&&(this.progress.$el.remove(),this.progress=!1),this}});function d(i){var e,t;(i=i).$el.is(".dropzone")&&(e=i.$('[data-uploader="wp"]').get(0))&&(i.$(".hide-if-value>p").contents().filter(function(){return 3==this.nodeType}).remove(),(t=new o).render(),t.$el.prependTo(i.$(".hide-if-value")),(r=new s({el:e})).render(),r.ready(),r.on("acf-dropzone-uploaded",function(e){i.render(e)}))}function a(i){var e=i.$(".acf-gallery-main").get(0);(i=i).$el.is(".dropzone")&&((r=new s({el:e})).render(),r.ready(),r.on("acf-dropzone-uploaded",function(e){i.appendAttachment(e,"prepend"===i.get("insert")?0:void 0)}))}acf.addAction("ready_field/type=image",d),acf.addAction("ready_field/type=file",d),acf.addAction("ready_field/type=gallery",a),acf.addAction("append_field/type=image",d),acf.addAction("append_field/type=file",d),acf.addAction("append_field/type=gallery",a)}(jQuery,acf_dropzone);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjZi1kcm9wem9uZS5qcyJdLCJuYW1lcyI6WyIkIiwiZHJvcHpvbmUiLCJVcGxvYWRlckluZm8iLCJ3cCIsIm1lZGlhIiwiVmlldyIsImV4dGVuZCIsInRhZ05hbWUiLCJjbGFzc05hbWUiLCJ0ZW1wbGF0ZSIsIlByb2dyZXNzIiwiQmFja2JvbmUiLCJyZW5kZXIiLCJ0aGlzIiwiJHByb2dyZXNzIiwiYWRkQ2xhc3MiLCIkbGFiZWwiLCIkYmFyIiwiJGVsIiwiYXBwZW5kIiwiYXBwZW5kVG8iLCJzZXRMYWJlbCIsImxhYmVsIiwidGV4dCIsInNldFByb2dyZXNzIiwicGVyY2VudCIsIndpZHRoIiwiTm90aWNlIiwiZXZlbnRzIiwiY2xpY2sgLm5vdGljZS1kaXNtaXNzIiwicHJvdG90eXBlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJvcHRpb25zIiwidHlwZSIsIkFDRkRyb3B6b25lIiwiaW5pdGlhbGl6ZSIsIm5vdGljZSIsInByb2dyZXNzIiwidXBsb2FkZXIiLCJ2aWV3IiwiVXBsb2FkZXJXaW5kb3ciLCJjb250cm9sbGVyIiwiZWwiLCJjb250YWluZXIiLCJyZWFkeSIsInRyaWdnZXIiLCJiaW5kIiwiZmlsZXNBZGRlZCIsImZpbGVCZWZvcmVVcGxvYWQiLCJmaWxlVXBsb2FkUHJvZ3Jlc3MiLCJmaWxlVXBsb2FkZWQiLCJmaWxlVXBsb2FkRXJyb3IiLCJmaWxlcyIsInRvdGFsIiwibGVuZ3RoIiwiZG9uZSIsImZpbGUiLCJyZW1vdmUiLCJhZGRQcm9ncmVzcyIsIl8iLCJlc2NhcGUiLCJuYW1lIiwicmVzcG9uc2UiLCJyZW1vdmVQcm9ncmVzcyIsImF0dGFjaG1lbnQiLCJlcnJvciIsImJvbGQiLCJtZXNzYWdlIiwicHJlcGVuZFRvIiwiaW5pdEZpbGVEcm9wem9uZSIsImZpZWxkIiwiaW5mbyIsImlzIiwiZ2V0IiwiY29udGVudHMiLCJmaWx0ZXIiLCJub2RlVHlwZSIsIm9uIiwiaW5pdEdhbGxlcnlEcm9wem9uZSIsImFwcGVuZEF0dGFjaG1lbnQi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QUFJLElBQ3pDSCxFQUFRQSxHQUVJckQsSUFBSXVELEdBQUcsZ0JBSXBCeEUsRUFBVyxJQUFJa0MsRUFBWSxDQUMxQlEsR0FBSUEsS0FFSS9CLFNBQ1RYLEVBQVM0QyxRQUNUNUMsRUFBUzZFLEdBQUcsd0JBQXlCLFNBQVViLEdBRTlDTSxFQUFNUyxpQkFDTGYsRUFDd0IsWUFBeEJNLEVBQU1HLElBQUksVUFBMEIsT0FBSU8sTUFPM0NDLElBQUlDLFVBQVcseUJBQTRCYixHQUMzQ1ksSUFBSUMsVUFBVyx3QkFBNEJiLEdBQzNDWSxJQUFJQyxVQUFXLDJCQUE0QkosR0FHM0NHLElBQUlDLFVBQVcsMEJBQTZCYixHQUM1Q1ksSUFBSUMsVUFBVyx5QkFBNkJiLEdBQzVDWSxJQUFJQyxVQUFXLDRCQUE2QkosR0FsTzdDLENBcU9HSyxPQUFRQyIsImZpbGUiOiJhY2YtZHJvcHpvbmUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCAkLCBkcm9wem9uZSApe1xuXHQvL1xuXHQvLyBkcm9wem9uZS5Ecm9wbG9hZGVyID0gd3AuVXBsb2FkZXIuZXh0ZW5kKHtcblx0Ly8gXHRpbml0OiAgICAgZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly8gXHRlcnJvcjogICAgZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly8gXHRzdWNjZXNzOiAgZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly8gXHRhZGRlZDogICAgZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly8gXHRwcm9ncmVzczogZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly8gXHRjb21wbGV0ZTogZnVuY3Rpb24oZSkge1xuXHQvLyBcdFx0Y29uc29sZS5sb2coZSk7XG5cdC8vIFx0fSxcblx0Ly9cblx0Ly8gfSk7XG5cblx0dmFyIFVwbG9hZGVySW5mbyA9IHdwLm1lZGlhLlZpZXcuZXh0ZW5kKHtcblx0XHR0YWdOYW1lOiAgICdkaXYnLFxuXHRcdGNsYXNzTmFtZTogJ2FjZi1kcm9wem9uZS1pbmZvJyxcblx0XHR0ZW1wbGF0ZTp3cC50ZW1wbGF0ZSgnYWNmLWRyb3B6b25lLWluZm8nKVxuXHR9KTtcblx0dmFyIFByb2dyZXNzID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXHRcdHRhZ05hbWU6ICAgJ2RpdicsXG5cdFx0Y2xhc3NOYW1lOiAnbWVkaWEtcHJvZ3Jlc3MtYmFyLWJveCcsXG5cdFx0cmVuZGVyOmZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy4kcHJvZ3Jlc3MgPSAkKCc8ZGl2IC8+JykuYWRkQ2xhc3MoJ21lZGlhLXByb2dyZXNzLWJhcicpO1xuXHRcdFx0dGhpcy4kbGFiZWwgPSAkKCc8ZGl2IC8+JykuYWRkQ2xhc3MoJ21lZGlhLXByb2dyZXNzLWxhYmVsJyk7XG5cdFx0XHR0aGlzLiRiYXIgPSAkKCc8ZGl2IC8+Jyk7XG5cdFx0XHR0aGlzLiRlbFxuXHRcdFx0XHQuYXBwZW5kKCB0aGlzLiRsYWJlbCApO1xuXHRcdFx0dGhpcy4kcHJvZ3Jlc3Ncblx0XHRcdFx0LmFwcGVuZCggdGhpcy4kYmFyIClcblx0XHRcdFx0LmFwcGVuZFRvKCB0aGlzLiRlbCApO1xuXG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHNldExhYmVsOmZ1bmN0aW9uKGxhYmVsKSB7XG5cdFx0XHR0aGlzLiRsYWJlbC50ZXh0KGxhYmVsKTtcblx0XHR9LFxuXHRcdHNldFByb2dyZXNzOmZ1bmN0aW9uKCBwZXJjZW50ICkge1xuXHRcdFx0dGhpcy4kYmFyLndpZHRoKCAoIHBlcmNlbnQgKSsnJScpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHR9KTtcblx0dmFyIE5vdGljZSA9IHdwLm1lZGlhLlZpZXcuZXh0ZW5kKHtcblx0XHR0ZW1wbGF0ZTp3cC50ZW1wbGF0ZSgnYWNmLWRyb3B6b25lLW5vdGljZScpLFxuXHRcdGNsYXNzTmFtZTonbm90aWNlIGlzLWRpc21pc3NpYmxlJyxcblx0XHRldmVudHM6e1xuXHRcdFx0J2NsaWNrIC5ub3RpY2UtZGlzbWlzcycgOiAncmVtb3ZlJyxcblx0XHR9LFxuXHRcdHJlbmRlcjpmdW5jdGlvbigpIHtcblx0XHRcdHdwLm1lZGlhLlZpZXcucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XG5cblx0XHRcdHRoaXMuJGVsLmFkZENsYXNzKHRoaXMub3B0aW9ucy50eXBlKTtcblx0XHR9XG5cdH0pXG5cblxuXHR2YXIgQUNGRHJvcHpvbmUgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG5cdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLm5vdGljZSA9IGZhbHNlO1xuXHRcdFx0dGhpcy5wcm9ncmVzcyA9IGZhbHNlO1xuXHRcdFx0dGhpcy51cGxvYWRlciA9IG5ldyB3cC5tZWRpYS52aWV3LlVwbG9hZGVyV2luZG93KHtcblx0XHRcdFx0Y29udHJvbGxlcjogdGhpcyxcblx0XHRcdFx0dXBsb2FkZXI6IHtcblx0XHRcdFx0XHRkcm9wem9uZTogIHRoaXMuZWwsXG5cdFx0XHRcdFx0Y29udGFpbmVyOiB0aGlzLmVsLFxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRyZW5kZXI6ZnVuY3Rpb24oKSB7XG5cdFx0XHQkKCB0aGlzLnVwbG9hZGVyLnJlbmRlcigpLmVsICkuYXBwZW5kVG8oIHRoaXMuZWwgKTtcblxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRyZWFkeTogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoJ2FjdGl2YXRlJylcblx0XHRcdHRoaXMudXBsb2FkZXIucmVhZHkoKTtcblx0XHRcdC8vXG5cdFx0XHR0aGlzLnVwbG9hZGVyLnVwbG9hZGVyLnVwbG9hZGVyLmJpbmQoJ0ZpbGVzQWRkZWQnLCB0aGlzLmZpbGVzQWRkZWQsIHRoaXMgKTtcblx0XHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnQmVmb3JlVXBsb2FkJywgdGhpcy5maWxlQmVmb3JlVXBsb2FkLCB0aGlzICk7XG5cdFx0XHR0aGlzLnVwbG9hZGVyLnVwbG9hZGVyLnVwbG9hZGVyLmJpbmQoJ1VwbG9hZFByb2dyZXNzJywgdGhpcy5maWxlVXBsb2FkUHJvZ3Jlc3MsIHRoaXMgKTtcblx0XHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnRmlsZVVwbG9hZGVkJywgdGhpcy5maWxlVXBsb2FkZWQsIHRoaXMgKTtcblx0XHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnZXJyb3InLCB0aGlzLmZpbGVVcGxvYWRFcnJvciwgdGhpcyApO1xuXG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdGZpbGVzQWRkZWQ6IGZ1bmN0aW9uKCB1cGxvYWRlciwgZmlsZXMgKSB7XG5cdFx0XHR0aGlzLnRvdGFsID0gZmlsZXMubGVuZ3RoO1xuXHRcdFx0dGhpcy5kb25lID0gMDtcblx0XHR9LFxuXHRcdGZpbGVCZWZvcmVVcGxvYWQ6IGZ1bmN0aW9uKCB1cGxvYWRlciwgZmlsZSApIHtcblx0XHRcdCEhIHRoaXMubm90aWNlICYmIHRoaXMubm90aWNlLnJlbW92ZSgpO1xuXHRcdFx0dGhpcy5hZGRQcm9ncmVzcygpO1xuXHRcdFx0dGhpcy5wcm9ncmVzcy5zZXRMYWJlbCggXy5lc2NhcGUoZmlsZS5uYW1lKSApO1xuXHRcdFx0dGhpcy5ub3RpY2UgPSBmYWxzZTtcblx0XHR9LFxuXHRcdGZpbGVVcGxvYWRQcm9ncmVzczpmdW5jdGlvbiggdXBsb2FkZXIsIGZpbGUgKSB7XG5cdFx0XHR0aGlzLmFkZFByb2dyZXNzKCk7XG5cdFx0XHR0aGlzLnByb2dyZXNzLnNldFByb2dyZXNzKCAoIDEwMCAqIHRoaXMuZG9uZSArIGZpbGUucGVyY2VudCApIC8gdGhpcy50b3RhbCApO1xuXHRcdH0sXG5cdFx0ZmlsZVVwbG9hZGVkOmZ1bmN0aW9uKCB1cGxvYWRlciwgZmlsZSwgcmVzcG9uc2UgKSB7XG5cdFx0XHR0aGlzLmRvbmUrKztcblx0XHRcdHRoaXMuZmlsZSA9IGZpbGU7XG5cdFx0XHR0aGlzLnJlbW92ZVByb2dyZXNzKCk7XG5cdFx0XHR0aGlzLnRyaWdnZXIoJ2FjZi1kcm9wem9uZS11cGxvYWRlZCcsZmlsZS5hdHRhY2htZW50KTtcblx0XHR9LFxuXHRcdGZpbGVVcGxvYWRFcnJvcjpmdW5jdGlvbiggdXBsb2FkZXIsIGVycm9yICkge1xuXHRcdFx0dGhpcy5kb25lKys7XG5cdFx0XHR0aGlzLnJlbW92ZVByb2dyZXNzKCk7XG5cdFx0XHR0aGlzLnRyaWdnZXIoICdhY2YtZHJvcHpvbmUtZXJyb3InLCBlcnJvciApO1xuXG5cdFx0XHR0aGlzLm5vdGljZSA9IG5ldyBOb3RpY2Uoe1xuXHRcdFx0XHR0eXBlOidlcnJvcicsXG5cdFx0XHRcdGJvbGQ6IF8uZXNjYXBlKGVycm9yLmZpbGUubmFtZSksXG5cdFx0XHRcdG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2Vcblx0XHRcdH0pO1xuXHRcdFx0dGhpcy5ub3RpY2UucmVuZGVyKCk7XG5cdFx0XHR0aGlzLm5vdGljZS4kZWwucHJlcGVuZFRvKHRoaXMuZWwpO1xuXHRcdFx0dGhpcy50b3RhbC0tO1xuXHRcdH0sXG5cblx0XHRhZGRQcm9ncmVzczpmdW5jdGlvbigpIHtcblx0XHRcdGlmICggdGhpcy5wcm9ncmVzcyApIHtcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnByb2dyZXNzID0gbmV3IFByb2dyZXNzKCk7XG5cdFx0XHR0aGlzLnByb2dyZXNzLnJlbmRlcigpLiRlbC5hcHBlbmRUbyh0aGlzLmVsKTtcblx0XHR9LFxuXHRcdHJlbW92ZVByb2dyZXNzOmZ1bmN0aW9uKCBwZXJjZW50ICkge1xuXHRcdFx0aWYgKCAhIHRoaXMucHJvZ3Jlc3MgKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnByb2dyZXNzLiRlbC5yZW1vdmUoKTtcblx0XHRcdHRoaXMucHJvZ3Jlc3MgPSBmYWxzZTtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdH0pO1xuLypcbjxkaXYgaWQ9XCJtZXNzYWdlXCIgY2xhc3M9XCJub3RpY2UgaXMtZGlzbWlzc2libGVcIj5cblx0PHA+bXNnPC9wPlxuXHQ8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cIm5vdGljZS1kaXNtaXNzXCI+XG5cdFx0PHNwYW4gY2xhc3M9XCJzY3JlZW4tcmVhZGVyLXRleHRcIj5EaXNtaXNzIHRoaXMgbm90aWNlLjwvc3Bhbj5cblx0PC9idXR0b24+XG48L2Rpdj5cbiovXG5cblxuXHRmdW5jdGlvbiBpbml0RmlsZURyb3B6b25lKCBmaWVsZCApIHtcblx0XHR2YXIgZWwsXG5cdFx0XHRmaWVsZCA9IGZpZWxkLFxuXHRcdFx0aW5mbztcblxuXHRcdGlmICggISBmaWVsZC4kZWwuaXMoJy5kcm9wem9uZScpICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGVsID0gZmllbGQuJCgnW2RhdGEtdXBsb2FkZXI9XCJ3cFwiXScpLmdldCgwKVxuXG5cdFx0aWYgKCAhIGVsICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHQvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xNTcxMDc2L3JlbW92ZS10ZXh0LXdpdGgtanF1ZXJ5XG5cdFx0ZmllbGQuJCgnLmhpZGUtaWYtdmFsdWU+cCcpXG5cdFx0XHQuY29udGVudHMoKVxuXHRcdFx0LmZpbHRlciggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLm5vZGVUeXBlID09IDM7IC8vTm9kZS5URVhUX05PREVcblx0XHRcdH0pXG5cdFx0XHQucmVtb3ZlKCk7XG5cblx0XHRpbmZvID0gbmV3IFVwbG9hZGVySW5mbygpO1xuXHRcdGluZm8ucmVuZGVyKCk7XG5cdFx0aW5mby4kZWwucHJlcGVuZFRvKCBmaWVsZC4kKCcuaGlkZS1pZi12YWx1ZScpICk7XG5cblx0XHRkcm9wem9uZSA9IG5ldyBBQ0ZEcm9wem9uZSh7XG5cdFx0XHRlbDogZWwsXG5cdFx0fSk7XG5cdFx0ZHJvcHpvbmUucmVuZGVyKCk7XG5cdFx0ZHJvcHpvbmUucmVhZHkoKTtcblx0XHRkcm9wem9uZS5vbignYWNmLWRyb3B6b25lLXVwbG9hZGVkJywgZnVuY3Rpb24oIGF0dGFjaG1lbnQgKXtcblx0XHRcdGZpZWxkLnJlbmRlcihhdHRhY2htZW50KTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIGluaXRHYWxsZXJ5RHJvcHpvbmUoIGZpZWxkICkge1xuXHRcdHZhciBlbCA9IGZpZWxkLiQoJy5hY2YtZ2FsbGVyeS1tYWluJykuZ2V0KDApLFxuXHRcdFx0ZmllbGQgPSBmaWVsZDtcblxuXHRcdGlmICggISBmaWVsZC4kZWwuaXMoJy5kcm9wem9uZScpICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGRyb3B6b25lID0gbmV3IEFDRkRyb3B6b25lKHtcblx0XHRcdGVsOiBlbCxcblx0XHR9KTtcblx0XHRkcm9wem9uZS5yZW5kZXIoKTtcblx0XHRkcm9wem9uZS5yZWFkeSgpO1xuXHRcdGRyb3B6b25lLm9uKCdhY2YtZHJvcHpvbmUtdXBsb2FkZWQnLCBmdW5jdGlvbiggYXR0YWNobWVudCApe1xuXG5cdFx0XHRmaWVsZC5hcHBlbmRBdHRhY2htZW50KFxuXHRcdFx0XHRhdHRhY2htZW50LFxuXHRcdFx0XHRmaWVsZC5nZXQoJ2luc2VydCcpID09PSAncHJlcGVuZCcgPyAwIDogdW5kZWZpbmVkXG5cdFx0XHQpO1xuXG5cdFx0fSk7XG5cdH1cblxuXG5cdGFjZi5hZGRBY3Rpb24oICdyZWFkeV9maWVsZC90eXBlPWltYWdlJywgICBpbml0RmlsZURyb3B6b25lICk7XG5cdGFjZi5hZGRBY3Rpb24oICdyZWFkeV9maWVsZC90eXBlPWZpbGUnLCAgICBpbml0RmlsZURyb3B6b25lICk7XG5cdGFjZi5hZGRBY3Rpb24oICdyZWFkeV9maWVsZC90eXBlPWdhbGxlcnknLCBpbml0R2FsbGVyeURyb3B6b25lICk7XG5cblx0Ly8gY3JlYXRlZCBmcm9tIHJlcGVhdGVyXG5cdGFjZi5hZGRBY3Rpb24oICdhcHBlbmRfZmllbGQvdHlwZT1pbWFnZScsICAgaW5pdEZpbGVEcm9wem9uZSApO1xuXHRhY2YuYWRkQWN0aW9uKCAnYXBwZW5kX2ZpZWxkL3R5cGU9ZmlsZScsICAgIGluaXRGaWxlRHJvcHpvbmUgKTtcblx0YWNmLmFkZEFjdGlvbiggJ2FwcGVuZF9maWVsZC90eXBlPWdhbGxlcnknLCBpbml0R2FsbGVyeURyb3B6b25lICk7XG5cblxufSkoalF1ZXJ5LCBhY2ZfZHJvcHpvbmUgKTtcbiJdfQ==
