!function(e,r){var s=wp.media.View.extend({tagName:"div",className:"acf-dropzone-info",template:wp.template("acf-dropzone-info")}),i=Backbone.View.extend({tagName:"div",className:"media-progress-bar-box",render:function(){return this.$progress=e("<div />").addClass("media-progress-bar"),this.$label=e("<div />").addClass("media-progress-label"),this.$bar=e("<div />"),this.$el.append(this.$label),this.$progress.append(this.$bar).appendTo(this.$el),this},setLabel:function(e){this.$label.text(e)},setProgress:function(e){return this.$bar.width(e+"%"),this}}),t=wp.media.View.extend({template:wp.template("acf-dropzone-notice"),className:"notice is-dismissible",events:{"click .notice-dismiss":"remove"},render:function(){wp.media.View.prototype.render.apply(this,arguments),this.$el.addClass(this.options.type)}}),o=Backbone.View.extend({initialize:function(){return this.notice=!1,this.progress=!1,this.uploader=new wp.media.view.UploaderWindow({controller:this,uploader:{dropzone:this.el,container:this.el}}),this},render:function(){return e(this.uploader.render().el).appendTo(this.el),this},ready:function(){return this.trigger("activate"),this.uploader.ready(),this.uploader.uploader.uploader.bind("FilesAdded",this.filesAdded,this),this.uploader.uploader.uploader.bind("BeforeUpload",this.fileBeforeUpload,this),this.uploader.uploader.uploader.bind("UploadProgress",this.fileUploadProgress,this),this.uploader.uploader.uploader.bind("FileUploaded",this.fileUploaded,this),this.uploader.uploader.uploader.bind("error",this.fileUploadError,this),this},filesAdded:function(e,i){this.total=i.length,this.done=0},fileBeforeUpload:function(e,i){this.notice&&this.notice.remove(),this.addProgress(),this.progress.setLabel(_.escape(i.name)),this.notice=!1},fileUploadProgress:function(e,i){this.addProgress(),this.progress.setProgress((100*this.done+i.percent)/this.total)},fileUploaded:function(e,i,t){this.done++,this.file=i,this.removeProgress(),this.trigger("acf-dropzone-uploaded",i.attachment)},fileUploadError:function(e,i){this.done++,this.removeProgress(),this.trigger("acf-dropzone-error",i),this.notice=new t({type:"error",bold:_.escape(i.file.name),message:i.message}),this.notice.render(),this.notice.$el.prependTo(this.el),this.total--},addProgress:function(){if(this.progress)return this;this.progress=new i,this.progress.render().$el.appendTo(this.el)},removeProgress:function(e){return this.progress&&(this.progress.$el.remove(),this.progress=!1),this}});function d(i){var e,t;(e=(i=i).$('[data-uploader="wp"]').get(0))&&(i.$(".hide-if-value>p").contents().filter(function(){return 3==this.nodeType}).remove(),(t=new s).render(),t.$el.prependTo(i.$(".hide-if-value")),(r=new o({el:e})).render(),r.ready(),r.on("acf-dropzone-uploaded",function(e){i.render(e)}))}function a(i){var e=i.$(".acf-gallery-main").get(0);i=i;(r=new o({el:e})).render(),r.ready(),r.on("acf-dropzone-uploaded",function(e){i.appendAttachment(e,"prepend"===i.get("insert")?0:void 0)})}acf.addAction("ready_field/type=image",d),acf.addAction("ready_field/type=file",d),acf.addAction("ready_field/type=gallery",a),acf.addAction("append_field/type=image",d),acf.addAction("append_field/type=file",d),acf.addAction("append_field/type=gallery",a)}(jQuery,acf_dropzone);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjZi1kcm9wem9uZS5qcyJdLCJuYW1lcyI6WyIkIiwiZHJvcHpvbmUiLCJVcGxvYWRlckluZm8iLCJ3cCIsIm1lZGlhIiwiVmlldyIsImV4dGVuZCIsInRhZ05hbWUiLCJjbGFzc05hbWUiLCJ0ZW1wbGF0ZSIsIlByb2dyZXNzIiwiQmFja2JvbmUiLCJyZW5kZXIiLCJ0aGlzIiwiJHByb2dyZXNzIiwiYWRkQ2xhc3MiLCIkbGFiZWwiLCIkYmFyIiwiJGVsIiwiYXBwZW5kIiwiYXBwZW5kVG8iLCJzZXRMYWJlbCIsImxhYmVsIiwidGV4dCIsInNldFByb2dyZXNzIiwicGVyY2VudCIsIndpZHRoIiwiTm90aWNlIiwiZXZlbnRzIiwiY2xpY2sgLm5vdGljZS1kaXNtaXNzIiwicHJvdG90eXBlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJvcHRpb25zIiwidHlwZSIsIkFDRkRyb3B6b25lIiwiaW5pdGlhbGl6ZSIsIm5vdGljZSIsInByb2dyZXNzIiwidXBsb2FkZXIiLCJ2aWV3IiwiVXBsb2FkZXJXaW5kb3ciLCJjb250cm9sbGVyIiwiZWwiLCJjb250YWluZXIiLCJyZWFkeSIsInRyaWdnZXIiLCJiaW5kIiwiZmlsZXNBZGRlZCIsImZpbGVCZWZvcmVVcGxvYWQiLCJmaWxlVXBsb2FkUHJvZ3Jlc3MiLCJmaWxlVXBsb2FkZWQiLCJmaWxlVXBsb2FkRXJyb3IiLCJmaWxlcyIsInRvdGFsIiwibGVuZ3RoIiwiZG9uZSIsImZpbGUiLCJyZW1vdmUiLCJhZGRQcm9ncmVzcyIsIl8iLCJlc2NhcGUiLCJuYW1lIiwicmVzcG9uc2UiLCJyZW1vdmVQcm9ncmVzcyIsImF0dGFjaG1lbnQiLCJlcnJvciIsImJvbGQiLCJtZXNzYWdlIiwicHJlcGVuZFRvIiwiaW5pdEZpbGVEcm9wem9uZSIsImZpZWxkIiwiaW5mbyIsImdldCIsImNvbnRlbnRzIiwiZmlsdGVyIiwibm9kZVR5cGUiLCJvbiIsImluaXRHYWxsZXJ5RHJvcHpvbmUiLCJhcHBlbmRBdHRhY2htZW50IiwidW5k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QUlrQyxFQUFZLENBQzFCUSxHQUFJQSxLQUVJL0IsU0FDVFgsRUFBUzRDLFFBQ1Q1QyxFQUFTNEUsR0FBRyx3QkFBeUIsU0FBVVosR0FFOUNNLEVBQU1RLGlCQUNMZCxFQUN3QixZQUF4Qk0sRUFBTUUsSUFBSSxVQUEwQixPQUFJTyxLQU8zQ0MsSUFBSUMsVUFBVyx5QkFBNEJaLEdBQzNDVyxJQUFJQyxVQUFXLHdCQUE0QlosR0FDM0NXLElBQUlDLFVBQVcsMkJBQTRCSixHQUczQ0csSUFBSUMsVUFBVywwQkFBNkJaLEdBQzVDVyxJQUFJQyxVQUFXLHlCQUE2QlosR0FDNUNXLElBQUlDLFVBQVcsNEJBQTZCSixHQXpON0MsQ0E0TkdLLE9BQVFDIiwiZmlsZSI6ImFjZi1kcm9wem9uZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oICQsIGRyb3B6b25lICl7XG5cdC8vXG5cdC8vIGRyb3B6b25lLkRyb3Bsb2FkZXIgPSB3cC5VcGxvYWRlci5leHRlbmQoe1xuXHQvLyBcdGluaXQ6ICAgICBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvLyBcdGVycm9yOiAgICBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvLyBcdHN1Y2Nlc3M6ICBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvLyBcdGFkZGVkOiAgICBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvLyBcdHByb2dyZXNzOiBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvLyBcdGNvbXBsZXRlOiBmdW5jdGlvbihlKSB7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhlKTtcblx0Ly8gXHR9LFxuXHQvL1xuXHQvLyB9KTtcblxuXHR2YXIgVXBsb2FkZXJJbmZvID0gd3AubWVkaWEuVmlldy5leHRlbmQoe1xuXHRcdHRhZ05hbWU6ICAgJ2RpdicsXG5cdFx0Y2xhc3NOYW1lOiAnYWNmLWRyb3B6b25lLWluZm8nLFxuXHRcdHRlbXBsYXRlOndwLnRlbXBsYXRlKCdhY2YtZHJvcHpvbmUtaW5mbycpXG5cdH0pO1xuXHR2YXIgUHJvZ3Jlc3MgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG5cdFx0dGFnTmFtZTogICAnZGl2Jyxcblx0XHRjbGFzc05hbWU6ICdtZWRpYS1wcm9ncmVzcy1iYXItYm94Jyxcblx0XHRyZW5kZXI6ZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLiRwcm9ncmVzcyA9ICQoJzxkaXYgLz4nKS5hZGRDbGFzcygnbWVkaWEtcHJvZ3Jlc3MtYmFyJyk7XG5cdFx0XHR0aGlzLiRsYWJlbCA9ICQoJzxkaXYgLz4nKS5hZGRDbGFzcygnbWVkaWEtcHJvZ3Jlc3MtbGFiZWwnKTtcblx0XHRcdHRoaXMuJGJhciA9ICQoJzxkaXYgLz4nKTtcblx0XHRcdHRoaXMuJGVsXG5cdFx0XHRcdC5hcHBlbmQoIHRoaXMuJGxhYmVsICk7XG5cdFx0XHR0aGlzLiRwcm9ncmVzc1xuXHRcdFx0XHQuYXBwZW5kKCB0aGlzLiRiYXIgKVxuXHRcdFx0XHQuYXBwZW5kVG8oIHRoaXMuJGVsICk7XG5cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdFx0c2V0TGFiZWw6ZnVuY3Rpb24obGFiZWwpIHtcblx0XHRcdHRoaXMuJGxhYmVsLnRleHQobGFiZWwpO1xuXHRcdH0sXG5cdFx0c2V0UHJvZ3Jlc3M6ZnVuY3Rpb24oIHBlcmNlbnQgKSB7XG5cdFx0XHR0aGlzLiRiYXIud2lkdGgoICggcGVyY2VudCApKyclJyk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdH0pO1xuXHR2YXIgTm90aWNlID0gd3AubWVkaWEuVmlldy5leHRlbmQoe1xuXHRcdHRlbXBsYXRlOndwLnRlbXBsYXRlKCdhY2YtZHJvcHpvbmUtbm90aWNlJyksXG5cdFx0Y2xhc3NOYW1lOidub3RpY2UgaXMtZGlzbWlzc2libGUnLFxuXHRcdGV2ZW50czp7XG5cdFx0XHQnY2xpY2sgLm5vdGljZS1kaXNtaXNzJyA6ICdyZW1vdmUnLFxuXHRcdH0sXG5cdFx0cmVuZGVyOmZ1bmN0aW9uKCkge1xuXHRcdFx0d3AubWVkaWEuVmlldy5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtcblxuXHRcdFx0dGhpcy4kZWwuYWRkQ2xhc3ModGhpcy5vcHRpb25zLnR5cGUpO1xuXHRcdH1cblx0fSlcblxuXG5cdHZhciBBQ0ZEcm9wem9uZSA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblx0XHRpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMubm90aWNlID0gZmFsc2U7XG5cdFx0XHR0aGlzLnByb2dyZXNzID0gZmFsc2U7XG5cdFx0XHR0aGlzLnVwbG9hZGVyID0gbmV3IHdwLm1lZGlhLnZpZXcuVXBsb2FkZXJXaW5kb3coe1xuXHRcdFx0XHRjb250cm9sbGVyOiB0aGlzLFxuXHRcdFx0XHR1cGxvYWRlcjoge1xuXHRcdFx0XHRcdGRyb3B6b25lOiAgdGhpcy5lbCxcblx0XHRcdFx0XHRjb250YWluZXI6IHRoaXMuZWwsXG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHJlbmRlcjpmdW5jdGlvbigpIHtcblx0XHRcdCQoIHRoaXMudXBsb2FkZXIucmVuZGVyKCkuZWwgKS5hcHBlbmRUbyggdGhpcy5lbCApO1xuXG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHJlYWR5OiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMudHJpZ2dlcignYWN0aXZhdGUnKVxuXHRcdFx0dGhpcy51cGxvYWRlci5yZWFkeSgpO1xuXHRcdFx0Ly9cblx0XHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnRmlsZXNBZGRlZCcsIHRoaXMuZmlsZXNBZGRlZCwgdGhpcyApO1xuXHRcdFx0dGhpcy51cGxvYWRlci51cGxvYWRlci51cGxvYWRlci5iaW5kKCdCZWZvcmVVcGxvYWQnLCB0aGlzLmZpbGVCZWZvcmVVcGxvYWQsIHRoaXMgKTtcblx0XHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnVXBsb2FkUHJvZ3Jlc3MnLCB0aGlzLmZpbGVVcGxvYWRQcm9ncmVzcywgdGhpcyApO1xuXHRcdFx0dGhpcy51cGxvYWRlci51cGxvYWRlci51cGxvYWRlci5iaW5kKCdGaWxlVXBsb2FkZWQnLCB0aGlzLmZpbGVVcGxvYWRlZCwgdGhpcyApO1xuXHRcdFx0dGhpcy51cGxvYWRlci51cGxvYWRlci51cGxvYWRlci5iaW5kKCdlcnJvcicsIHRoaXMuZmlsZVVwbG9hZEVycm9yLCB0aGlzICk7XG5cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdFx0ZmlsZXNBZGRlZDogZnVuY3Rpb24oIHVwbG9hZGVyLCBmaWxlcyApIHtcblx0XHRcdHRoaXMudG90YWwgPSBmaWxlcy5sZW5ndGg7XG5cdFx0XHR0aGlzLmRvbmUgPSAwO1xuXHRcdH0sXG5cdFx0ZmlsZUJlZm9yZVVwbG9hZDogZnVuY3Rpb24oIHVwbG9hZGVyLCBmaWxlICkge1xuXHRcdFx0ISEgdGhpcy5ub3RpY2UgJiYgdGhpcy5ub3RpY2UucmVtb3ZlKCk7XG5cdFx0XHR0aGlzLmFkZFByb2dyZXNzKCk7XG5cdFx0XHR0aGlzLnByb2dyZXNzLnNldExhYmVsKCBfLmVzY2FwZShmaWxlLm5hbWUpICk7XG5cdFx0XHR0aGlzLm5vdGljZSA9IGZhbHNlO1xuXHRcdH0sXG5cdFx0ZmlsZVVwbG9hZFByb2dyZXNzOmZ1bmN0aW9uKCB1cGxvYWRlciwgZmlsZSApIHtcblx0XHRcdHRoaXMuYWRkUHJvZ3Jlc3MoKTtcblx0XHRcdHRoaXMucHJvZ3Jlc3Muc2V0UHJvZ3Jlc3MoICggMTAwICogdGhpcy5kb25lICsgZmlsZS5wZXJjZW50ICkgLyB0aGlzLnRvdGFsICk7XG5cdFx0fSxcblx0XHRmaWxlVXBsb2FkZWQ6ZnVuY3Rpb24oIHVwbG9hZGVyLCBmaWxlLCByZXNwb25zZSApIHtcblx0XHRcdHRoaXMuZG9uZSsrO1xuXHRcdFx0dGhpcy5maWxlID0gZmlsZTtcblx0XHRcdHRoaXMucmVtb3ZlUHJvZ3Jlc3MoKTtcblx0XHRcdHRoaXMudHJpZ2dlcignYWNmLWRyb3B6b25lLXVwbG9hZGVkJyxmaWxlLmF0dGFjaG1lbnQpO1xuXHRcdH0sXG5cdFx0ZmlsZVVwbG9hZEVycm9yOmZ1bmN0aW9uKCB1cGxvYWRlciwgZXJyb3IgKSB7XG5cdFx0XHR0aGlzLmRvbmUrKztcblx0XHRcdHRoaXMucmVtb3ZlUHJvZ3Jlc3MoKTtcblx0XHRcdHRoaXMudHJpZ2dlciggJ2FjZi1kcm9wem9uZS1lcnJvcicsIGVycm9yICk7XG5cblx0XHRcdHRoaXMubm90aWNlID0gbmV3IE5vdGljZSh7XG5cdFx0XHRcdHR5cGU6J2Vycm9yJyxcblx0XHRcdFx0Ym9sZDogXy5lc2NhcGUoZXJyb3IuZmlsZS5uYW1lKSxcblx0XHRcdFx0bWVzc2FnZTogZXJyb3IubWVzc2FnZVxuXHRcdFx0fSk7XG5cdFx0XHR0aGlzLm5vdGljZS5yZW5kZXIoKTtcblx0XHRcdHRoaXMubm90aWNlLiRlbC5wcmVwZW5kVG8odGhpcy5lbCk7XG5cdFx0XHR0aGlzLnRvdGFsLS07XG5cdFx0fSxcblxuXHRcdGFkZFByb2dyZXNzOmZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCB0aGlzLnByb2dyZXNzICkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH1cblx0XHRcdHRoaXMucHJvZ3Jlc3MgPSBuZXcgUHJvZ3Jlc3MoKTtcblx0XHRcdHRoaXMucHJvZ3Jlc3MucmVuZGVyKCkuJGVsLmFwcGVuZFRvKHRoaXMuZWwpO1xuXHRcdH0sXG5cdFx0cmVtb3ZlUHJvZ3Jlc3M6ZnVuY3Rpb24oIHBlcmNlbnQgKSB7XG5cdFx0XHRpZiAoICEgdGhpcy5wcm9ncmVzcyApIHtcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMucHJvZ3Jlc3MuJGVsLnJlbW92ZSgpO1xuXHRcdFx0dGhpcy5wcm9ncmVzcyA9IGZhbHNlO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0fSk7XG4vKlxuPGRpdiBpZD1cIm1lc3NhZ2VcIiBjbGFzcz1cIm5vdGljZSBpcy1kaXNtaXNzaWJsZVwiPlxuXHQ8cD5tc2c8L3A+XG5cdDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwibm90aWNlLWRpc21pc3NcIj5cblx0XHQ8c3BhbiBjbGFzcz1cInNjcmVlbi1yZWFkZXItdGV4dFwiPkRpc21pc3MgdGhpcyBub3RpY2UuPC9zcGFuPlxuXHQ8L2J1dHRvbj5cbjwvZGl2PlxuKi9cblxuXG5cdGZ1bmN0aW9uIGluaXRGaWxlRHJvcHpvbmUoIGZpZWxkICkge1xuXHRcdHZhciBlbCxcblx0XHRcdGZpZWxkID0gZmllbGQsXG5cdFx0XHRpbmZvO1xuXG5cdFx0ZWwgPSBmaWVsZC4kKCdbZGF0YS11cGxvYWRlcj1cIndwXCJdJykuZ2V0KDApXG5cblx0XHRpZiAoICEgZWwgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE1NzEwNzYvcmVtb3ZlLXRleHQtd2l0aC1qcXVlcnlcblx0XHRmaWVsZC4kKCcuaGlkZS1pZi12YWx1ZT5wJylcblx0XHRcdC5jb250ZW50cygpXG5cdFx0XHQuZmlsdGVyKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMubm9kZVR5cGUgPT0gMzsgLy9Ob2RlLlRFWFRfTk9ERVxuXHRcdFx0fSlcblx0XHRcdC5yZW1vdmUoKTtcblxuXHRcdGluZm8gPSBuZXcgVXBsb2FkZXJJbmZvKCk7XG5cdFx0aW5mby5yZW5kZXIoKTtcblx0XHRpbmZvLiRlbC5wcmVwZW5kVG8oIGZpZWxkLiQoJy5oaWRlLWlmLXZhbHVlJykgKTtcblxuXHRcdGRyb3B6b25lID0gbmV3IEFDRkRyb3B6b25lKHtcblx0XHRcdGVsOiBlbCxcblx0XHR9KTtcblx0XHRkcm9wem9uZS5yZW5kZXIoKTtcblx0XHRkcm9wem9uZS5yZWFkeSgpO1xuXHRcdGRyb3B6b25lLm9uKCdhY2YtZHJvcHpvbmUtdXBsb2FkZWQnLCBmdW5jdGlvbiggYXR0YWNobWVudCApe1xuXHRcdFx0ZmllbGQucmVuZGVyKGF0dGFjaG1lbnQpO1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gaW5pdEdhbGxlcnlEcm9wem9uZSggZmllbGQgKSB7XG5cdFx0dmFyIGVsID0gZmllbGQuJCgnLmFjZi1nYWxsZXJ5LW1haW4nKS5nZXQoMCksXG5cdFx0XHRmaWVsZCA9IGZpZWxkO1xuXHRcdGRyb3B6b25lID0gbmV3IEFDRkRyb3B6b25lKHtcblx0XHRcdGVsOiBlbCxcblx0XHR9KTtcblx0XHRkcm9wem9uZS5yZW5kZXIoKTtcblx0XHRkcm9wem9uZS5yZWFkeSgpO1xuXHRcdGRyb3B6b25lLm9uKCdhY2YtZHJvcHpvbmUtdXBsb2FkZWQnLCBmdW5jdGlvbiggYXR0YWNobWVudCApe1xuXG5cdFx0XHRmaWVsZC5hcHBlbmRBdHRhY2htZW50KFxuXHRcdFx0XHRhdHRhY2htZW50LFxuXHRcdFx0XHRmaWVsZC5nZXQoJ2luc2VydCcpID09PSAncHJlcGVuZCcgPyAwIDogdW5kZWZpbmVkXG5cdFx0XHQpO1xuXG5cdFx0fSk7XG5cdH1cblxuXG5cdGFjZi5hZGRBY3Rpb24oICdyZWFkeV9maWVsZC90eXBlPWltYWdlJywgICBpbml0RmlsZURyb3B6b25lICk7XG5cdGFjZi5hZGRBY3Rpb24oICdyZWFkeV9maWVsZC90eXBlPWZpbGUnLCAgICBpbml0RmlsZURyb3B6b25lICk7XG5cdGFjZi5hZGRBY3Rpb24oICdyZWFkeV9maWVsZC90eXBlPWdhbGxlcnknLCBpbml0R2FsbGVyeURyb3B6b25lICk7XG5cblx0Ly8gY3JlYXRlZCBmcm9tIHJlcGVhdGVyXG5cdGFjZi5hZGRBY3Rpb24oICdhcHBlbmRfZmllbGQvdHlwZT1pbWFnZScsICAgaW5pdEZpbGVEcm9wem9uZSApO1xuXHRhY2YuYWRkQWN0aW9uKCAnYXBwZW5kX2ZpZWxkL3R5cGU9ZmlsZScsICAgIGluaXRGaWxlRHJvcHpvbmUgKTtcblx0YWNmLmFkZEFjdGlvbiggJ2FwcGVuZF9maWVsZC90eXBlPWdhbGxlcnknLCBpbml0R2FsbGVyeURyb3B6b25lICk7XG5cblxufSkoalF1ZXJ5LCBhY2ZfZHJvcHpvbmUgKTtcbiJdfQ==
