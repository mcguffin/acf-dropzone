!function s(n,a,d){function l(t,e){if(!a[t]){if(!n[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(p)return p(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var o=a[t]={exports:{}};n[t][0].call(o.exports,function(e){return l(n[t][1][e]||e)},o,o.exports,s,n,a,d)}return a[t].exports}for(var p="function"==typeof require&&require,e=0;e<d.length;e++)l(d[e]);return l}({1:[function(o,e,t){(function(e){"use strict";t("undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null);var s=t(o("uploader-info.js")),n=t(o("acf-dropzone.js"));function t(e){return e&&e.__esModule?e:{default:e}}function r(r){var e,i,t,o;r.$el.is(".dropzone")&&(i=r.parent(),(e=r.$('[data-uploader="wp"]').get(0))&&(r.$(".hide-if-value>p").contents().filter(function(){return 3==this.nodeType}).remove(),(t=new s.default({or:!0})).render(),t.$el.prependTo(r.$(".hide-if-value")),(o=new n.default({el:e,field:r})).render(),o.ready(),o.on("acf-dropzone-uploaded",function(e,t){i&&"repeater"===i.get("type")&&0<t?r.append(e,i):r.render(e)})))}function i(t){var e,r,i=t.$(".acf-gallery-attachments").get(0);t.$el.is(".dropzone")&&((r=new s.default({or:!1})).render(),r.$el.prependTo(i),(e=new n.default({el:i,field:t})).render(),e.ready(),e.on("acf-dropzone-uploaded",function(e){t.appendAttachment(e,"prepend"===t.get("insert")?0:void 0)}))}jQuery,acf_dropzone,acf.addAction("ready_field/type=image",r),acf.addAction("ready_field/type=file",r),acf.addAction("ready_field/type=gallery",i),acf.addAction("append_field/type=image",r),acf.addAction("append_field/type=file",r),acf.addAction("append_field/type=gallery",i)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"acf-dropzone.js":2,"uploader-info.js":6}],2:[function(e,t,r){"use strict";var i=n(e("notice.js")),o=n(e("pasteboard.js")),s=n(e("progress.js"));function n(e){return e&&e.__esModule?e:{default:e}}t.exports=Backbone.View.extend({initialize:function(e){return this.field=e.field,this.notice=!1,this.progress=!1,this.uploader=new wp.media.view.UploaderWindow({controller:this,uploader:{dropzone:this.el,container:this.el,params:{_acfuploader:this.field.get("key")}}}),this.pasteboard=new o.default({controller:this,el:this.$el.is('[data-uploader="wp"]')?this.el:this.field.$(".acf-gallery-attachments").get(0)}),this},render:function(){return $(this.uploader.render().el).appendTo(this.el),this.pasteboard.render(),this},ready:function(){var t=this;return this.$el.on("drop dragenter dragleave dragover",function(e){e.stopPropagation()}).on("drop",function(e){t.removeNotice()}),this.trigger("activate"),this.uploader.ready(),this.uploader.uploader.uploader.bind("FilesAdded",this.filesAdded,this),this.uploader.uploader.uploader.bind("BeforeUpload",this.fileBeforeUpload,this),this.uploader.uploader.uploader.bind("UploadProgress",this.fileUploadProgress,this),this.uploader.uploader.uploader.bind("FileUploaded",this.fileUploaded,this),this.uploader.uploader.uploader.bind("error",this.fileUploadError,this),this.pasteboard.render(),this},filesAdded:function(e,t){this.total=t.length,this.done=0},fileBeforeUpload:function(e,t){this.addProgress(),this.progress.setLabel(_.escape(t.name))},fileUploadProgress:function(e,t){this.addProgress(),this.progress.setProgress((100*this.done+t.percent)/this.total)},fileUploaded:function(t,e,r){var i;this.file=e;try{this.trigger("acf-dropzone-uploaded",e.attachment,this.done),this.done++,this.total===this.done&&this.removeProgress()}catch(e){try{i=JSON.parse(r.response),this.fileUploadError(t,{file:this.file,message:i.data.message})}catch(e){this.fileUploadError(t,{file:this.file,message:r.response})}}},fileUploadError:function(e,t){this.done++,this.total===this.done&&this.removeProgress(),this.trigger("acf-dropzone-error",t),this.addNotice({type:"error",bold:_.escape(t.file.name),message:t.message})},addProgress:function(){return this.progress||(this.progress=new s.default,this.progress.render().$el.prependTo(this.el)),this},removeProgress:function(e){return this.progress&&(this.progress.$el.remove(),this.progress=!1),this},addNotice:function(e){return this.notice=new i.default(e),this.notice.render(),this.notice.$el.prependTo(this.el),this},removeNotice:function(e){return this.notice&&(this.notice.remove(),this.notice=!1),this}})},{"notice.js":3,"pasteboard.js":4,"progress.js":5}],3:[function(e,t,r){"use strict";t.exports=wp.media.View.extend({template:wp.template("acf-dropzone-notice"),className:"notice is-dismissible",events:{"click .notice-dismiss":"remove"},render:function(){return wp.media.View.prototype.render.apply(this,arguments),this.$el.addClass(this.options.type),this}})},{}],4:[function(e,t,r){"use strict";t.exports=Backbone.View.extend({events:{focus:"listenPaste",blur:"stopListenPaste"},listenPaste:function(e){var t=this;this.$el.on("paste",function(){t.onPaste.apply(t,arguments)})},stopListenPaste:function(){this.$el.off("paste")},initialize:function(e){return Backbone.View.prototype.initialize.apply(this,arguments),this.controller=e.controller,this},render:function(){return this.$el.attr("tabindex","-1"),this},onPaste:function(e){e.preventDefault(),e.stopPropagation();var t,r,i=e.originalEvent.clipboardData.items;for(t=0;t<i.length;t++)"file"===i[t].kind&&(r=i[t].getAsFile())&&(this.controller.uploader.uploader.param("post_data",{post_title:wp.template("acf-dropzone-attachment-title")({fieldname:this.controller.field.get("name")}).trim(),post_type:"attachment"}),this.controller.uploader.uploader.uploader.addFile(r,r.name));return this}})},{}],5:[function(e,t,r){"use strict";t.exports=Backbone.View.extend({tagName:"div",className:"media-progress-bar-box",render:function(){return this.$progress=$("<div />").addClass("media-progress-bar"),this.$label=$("<div />").addClass("media-progress-label"),this.$bar=$("<div />"),this.$el.append(this.$label),this.$progress.append(this.$bar).appendTo(this.$el),this},setLabel:function(e){return this.$label.text(e),this},setProgress:function(e){return this.$bar.width(e+"%"),this}})},{}],6:[function(e,t,r){"use strict";t.exports=wp.media.View.extend({tagName:"div",className:"acf-dropzone-info",template:wp.template("acf-dropzone-info")})},{}]},{},[1]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhZG1pbi9zcmMvanMvYWRtaW4vYWNmLWRyb3B6b25lL2luZGV4LmpzIiwiYWRtaW4vc3JjL2pzL2xpYi9hY2YtZHJvcHpvbmUuanMiLCJhZG1pbi9zcmMvanMvbGliL25vdGljZS5qcyIsImFkbWluL3NyYy9qcy9saWIvcGFzdGVib2FyZC5qcyIsImFkbWluL3NyYy9qcy9saWIvcHJvZ3Jlc3MuanMiLCJhZG1pbi9zcmMvanMvbGliL3VwbG9hZGVyLWluZm8uanMiXSwibmFtZXMiOlsiciIsImUiLCJuIiwidCIsIm8iLCJpIiwiZiIsImMiLCJyZXF1aXJlIiwidSIsImEiLCJFcnJvciIsImNvZGUiLCJwIiwiZXhwb3J0cyIsImNhbGwiLCJsZW5ndGgiLCIxIiwibW9kdWxlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIndpbmRvdyIsImdsb2JhbCIsIl91cGxvYWRlckluZm8iLCJfYWNmRHJvcHpvbmUiLCJpbml0RmlsZURyb3B6b25lIiwiZmllbGQiLCJlbCIsInBhcmVudCIsImluZm8iLCJkcm9wem9uZSIsIiRlbCIsImlzIiwiJCIsImdldCIsImNvbnRlbnRzIiwiZmlsdGVyIiwidGhpcyIsIm5vZGVUeXBlIiwicmVtb3ZlIiwiZGVmYXVsdCIsIm9yIiwicmVuZGVyIiwicHJlcGVuZFRvIiwicmVhZHkiLCJvbiIsImF0dGFjaG1lbnQiLCJhcHBlbmQiLCJpbml0R2FsbGVyeURyb3B6b25lIiwiYXBwZW5kQXR0YWNobWVudCIsInVuZGVmaW5lZCIsImpRdWVyeSIsImFjZl9kcm9wem9uZSIsImFjZiIsImFkZEFjdGlvbiIsIl9ub3RpY2UiLCJfcGFzdGVib2FyZCIsIl9wcm9ncmVzcyIsIkJhY2tib25lIiwiVmlldyIsImV4dGVuZCIsImluaXRpYWxpemUiLCJvcHQiLCJub3RpY2UiLCJwcm9ncmVzcyIsInVwbG9hZGVyIiwid3AiLCJtZWRpYSIsInZpZXciLCJVcGxvYWRlcldpbmRvdyIsImNvbnRyb2xsZXIiLCJjb250YWluZXIiLCJwYXJhbXMiLCJfYWNmdXBsb2FkZXIiLCJwYXN0ZWJvYXJkIiwiYXBwZW5kVG8iLCJzZWxmIiwic3RvcFByb3BhZ2F0aW9uIiwicmVtb3ZlTm90aWNlIiwidHJpZ2dlciIsImJpbmQiLCJmaWxlc0FkZGVkIiwiZmlsZUJlZm9yZVVwbG9hZCIsImZpbGVVcGxvYWRQcm9ncmVzcyIsImZpbGVVcGxvYWRlZCIsImZpbGVVcGxvYWRFcnJvciIsImZpbGVzIiwidG90YWwiLCJkb25lIiwiZmlsZSIsImFkZFByb2dyZXNzIiwic2V0TGFiZWwiLCJfIiwiZXNjYXBlIiwibmFtZSIsInNldFByb2dyZXNzIiwicGVyY2VudCIsInJlc3BvbnNlIiwicmVzdWx0IiwicmVtb3ZlUHJvZ3Jlc3MiLCJlcnIiLCJKU09OIiwicGFyc2UiLCJtZXNzYWdlIiwiZGF0YSIsImVycjIiLCJlcnJvciIsImFkZE5vdGljZSIsInR5cGUiLCJib2xkIiwib3B0aW9ucyIsInRlbXBsYXRlIiwiY2xhc3NOYW1lIiwiZXZlbnRzIiwiY2xpY2sgLm5vdGljZS1kaXNtaXNzIiwicHJvdG90eXBlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJhZGRDbGFzcyIsImZvY3VzIiwiYmx1ciIsImxpc3RlblBhc3RlIiwib25QYXN0ZSIsInN0b3BMaXN0ZW5QYXN0ZSIsIm9mZiIsImF0dHIiLCJwcmV2ZW50RGVmYXVsdCIsImJsb2IiLCJpdGVtcyIsIm9yaWdpbmFsRXZlbnQiLCJjbGlwYm9hcmREYXRhIiwia2luZCIsImdldEFzRmlsZSIsInBhcmFtIiwicG9zdF90aXRsZSIsImZpZWxkbmFtZSIsInRyaW0iLCJwb3N0X3R5cGUiLCJhZGRGaWxlIiwidGFnTmFtZSIsIiRwcm9ncmVzcyIsIiRsYWJlbCIsIiRiYXIiLCJsYWJlbCIsInRleHQiLCJ3aWR0aCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsRUFBQUMsRUFBQUMsR0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUFBLElB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QUtHLE1BQVNqRCxFQUFVLEtBQ3RCM0QsNkNDckJUbEIsRUFBT0osUUFBVW1ELEdBQUdDLE1BQU1SLEtBQUtDLE9BQU8sQ0FDckMrRSxRQUFXLE1BQ1gzQixVQUFXLG9CQUNYRCxTQUFTN0MsR0FBRzZDLFNBQVMiLCJmaWxlIjoiYWRtaW4vYWNmLWRyb3B6b25lLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5pbXBvcnQgVXBsb2FkZXJJbmZvIGZyb20gJ3VwbG9hZGVyLWluZm8uanMnO1xuaW1wb3J0IEFDRkRyb3B6b25lIGZyb20gJ2FjZi1kcm9wem9uZS5qcyc7XG5cblxuKGZ1bmN0aW9uKCAkICl7XG5cblxuXHRjb25zdCBpbml0RmlsZURyb3B6b25lID0gZmllbGQgPT4ge1xuXHRcdGxldCBlbCxcblx0XHRcdHBhcmVudCxcblx0XHRcdGluZm8sXG5cdFx0XHRkcm9wem9uZTtcblxuXHRcdGlmICggISBmaWVsZC4kZWwuaXMoJy5kcm9wem9uZScpICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHBhcmVudCA9IGZpZWxkLnBhcmVudCgpO1xuXG5cdFx0ZWwgPSBmaWVsZC4kKCdbZGF0YS11cGxvYWRlcj1cIndwXCJdJykuZ2V0KDApXG5cblx0XHRpZiAoICEgZWwgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE1NzEwNzYvcmVtb3ZlLXRleHQtd2l0aC1qcXVlcnlcblx0XHRmaWVsZC4kKCcuaGlkZS1pZi12YWx1ZT5wJylcblx0XHRcdC5jb250ZW50cygpXG5cdFx0XHQuZmlsdGVyKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMubm9kZVR5cGUgPT0gMzsgLy9Ob2RlLlRFWFRfTk9ERVxuXHRcdFx0fSlcblx0XHRcdC5yZW1vdmUoKTtcblxuXHRcdGluZm8gPSBuZXcgVXBsb2FkZXJJbmZvKHtvcjp0cnVlfSk7XG5cdFx0aW5mby5yZW5kZXIoKTtcblx0XHRpbmZvLiRlbC5wcmVwZW5kVG8oIGZpZWxkLiQoJy5oaWRlLWlmLXZhbHVlJykgKTtcblxuXG5cdFx0ZHJvcHpvbmUgPSBuZXcgQUNGRHJvcHpvbmUoe1xuXHRcdFx0ZWw6IGVsLFxuXHRcdFx0ZmllbGQ6IGZpZWxkXG5cdFx0fSk7XG5cdFx0ZHJvcHpvbmUucmVuZGVyKCk7XG5cdFx0ZHJvcHpvbmUucmVhZHkoKTtcblx0XHRkcm9wem9uZS5vbignYWNmLWRyb3B6b25lLXVwbG9hZGVkJywgKCBhdHRhY2htZW50LCBpICkgPT4ge1xuXHRcdFx0aWYgKCBwYXJlbnQgJiYgcGFyZW50LmdldCgndHlwZScpID09PSAncmVwZWF0ZXInICYmIGkgPiAwICkge1xuXHRcdFx0XHRmaWVsZC5hcHBlbmQoIGF0dGFjaG1lbnQsIHBhcmVudCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZmllbGQucmVuZGVyKGF0dGFjaG1lbnQpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdGNvbnN0IGluaXRHYWxsZXJ5RHJvcHpvbmUgPSBmaWVsZCA9PiB7XG5cblx0XHRsZXQgZHJvcHpvbmUsXG5cdFx0XHRpbmZvLFxuXHRcdFx0ZWwgPSBmaWVsZC4kKCcuYWNmLWdhbGxlcnktYXR0YWNobWVudHMnKS5nZXQoMCk7XG5cblx0XHRpZiAoICEgZmllbGQuJGVsLmlzKCcuZHJvcHpvbmUnKSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0aW5mbyA9IG5ldyBVcGxvYWRlckluZm8oe29yOmZhbHNlfSk7XG5cdFx0aW5mby5yZW5kZXIoKTtcblx0XHRpbmZvLiRlbC5wcmVwZW5kVG8oIGVsICk7XG5cblx0XHRkcm9wem9uZSA9IG5ldyBBQ0ZEcm9wem9uZSh7XG5cdFx0XHRlbDogZWwsXG5cdFx0XHRmaWVsZDogZmllbGRcblx0XHR9KTtcblx0XHRkcm9wem9uZS5yZW5kZXIoKTtcblx0XHRkcm9wem9uZS5yZWFkeSgpO1xuXHRcdGRyb3B6b25lLm9uKCdhY2YtZHJvcHpvbmUtdXBsb2FkZWQnLCBhdHRhY2htZW50ID0+IHtcblxuXHRcdFx0ZmllbGQuYXBwZW5kQXR0YWNobWVudChcblx0XHRcdFx0YXR0YWNobWVudCxcblx0XHRcdFx0ZmllbGQuZ2V0KCdpbnNlcnQnKSA9PT0gJ3ByZXBlbmQnID8gMCA6IHVuZGVmaW5lZFxuXHRcdFx0KTtcblxuXHRcdH0pO1xuXHR9XG5cblxuXHRhY2YuYWRkQWN0aW9uKCAncmVhZHlfZmllbGQvdHlwZT1pbWFnZScsICAgaW5pdEZpbGVEcm9wem9uZSApO1xuXHRhY2YuYWRkQWN0aW9uKCAncmVhZHlfZmllbGQvdHlwZT1maWxlJywgICAgaW5pdEZpbGVEcm9wem9uZSApO1xuXHRhY2YuYWRkQWN0aW9uKCAncmVhZHlfZmllbGQvdHlwZT1nYWxsZXJ5JywgaW5pdEdhbGxlcnlEcm9wem9uZSApO1xuXG5cdC8vIGNyZWF0ZWQgZnJvbSByZXBlYXRlclxuXHRhY2YuYWRkQWN0aW9uKCAnYXBwZW5kX2ZpZWxkL3R5cGU9aW1hZ2UnLCAgIGluaXRGaWxlRHJvcHpvbmUgKTtcblx0YWNmLmFkZEFjdGlvbiggJ2FwcGVuZF9maWVsZC90eXBlPWZpbGUnLCAgICBpbml0RmlsZURyb3B6b25lICk7XG5cdGFjZi5hZGRBY3Rpb24oICdhcHBlbmRfZmllbGQvdHlwZT1nYWxsZXJ5JywgaW5pdEdhbGxlcnlEcm9wem9uZSApO1xuXG5cbn0pKGpRdWVyeSwgYWNmX2Ryb3B6b25lICk7XG4iLCJpbXBvcnQgTm90aWNlIGZyb20gJ25vdGljZS5qcyc7XG5pbXBvcnQgUGFzdGVib2FyZCBmcm9tICdwYXN0ZWJvYXJkLmpzJztcbmltcG9ydCBQcm9ncmVzcyBmcm9tICdwcm9ncmVzcy5qcyc7XG5cblxubW9kdWxlLmV4cG9ydHMgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKCBvcHQgKSB7XG5cblx0XHR0aGlzLmZpZWxkID0gb3B0LmZpZWxkO1xuXG5cdFx0dGhpcy5ub3RpY2UgPSBmYWxzZTtcblx0XHR0aGlzLnByb2dyZXNzID0gZmFsc2U7XG5cdFx0dGhpcy51cGxvYWRlciA9IG5ldyB3cC5tZWRpYS52aWV3LlVwbG9hZGVyV2luZG93KHtcblx0XHRcdGNvbnRyb2xsZXI6IHRoaXMsXG5cdFx0XHR1cGxvYWRlcjoge1xuXHRcdFx0XHRkcm9wem9uZTogIHRoaXMuZWwsXG5cdFx0XHRcdGNvbnRhaW5lcjogdGhpcy5lbCxcblx0XHRcdFx0cGFyYW1zOiB7XG5cdFx0XHRcdFx0X2FjZnVwbG9hZGVyOiB0aGlzLmZpZWxkLmdldCgna2V5JyksXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMucGFzdGVib2FyZCA9IG5ldyBQYXN0ZWJvYXJkKHtcblx0XHRcdGNvbnRyb2xsZXI6IHRoaXMsXG5cdFx0XHRlbDogdGhpcy4kZWwuaXMoJ1tkYXRhLXVwbG9hZGVyPVwid3BcIl0nKSA/IHRoaXMuZWwgOiB0aGlzLmZpZWxkLiQoJy5hY2YtZ2FsbGVyeS1hdHRhY2htZW50cycpLmdldCgwKVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cdHJlbmRlcjpmdW5jdGlvbigpIHtcblx0XHQkKCB0aGlzLnVwbG9hZGVyLnJlbmRlcigpLmVsICkuYXBwZW5kVG8oIHRoaXMuZWwgKTtcblxuXHRcdHRoaXMucGFzdGVib2FyZC5yZW5kZXIoKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXHRyZWFkeTogZnVuY3Rpb24oKSB7XG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0dGhpcy4kZWxcblx0XHQub24oJ2Ryb3AgZHJhZ2VudGVyIGRyYWdsZWF2ZSBkcmFnb3ZlcicsZnVuY3Rpb24oZSl7XG5cdFx0XHQvLyBwcmV2ZW50IGJsb2NrIGVkaXRvciBmaWxlIGRyb3Bcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKClcblx0XHR9KVxuXHRcdC5vbignZHJvcCcsZnVuY3Rpb24oZSl7XG5cdFx0XHQvLyByZXNldCBlcnJvclxuXHRcdFx0c2VsZi5yZW1vdmVOb3RpY2UoKTtcblx0XHR9KTtcblxuXHRcdHRoaXMudHJpZ2dlcignYWN0aXZhdGUnKVxuXHRcdHRoaXMudXBsb2FkZXIucmVhZHkoKTtcblx0XHQvL1xuXHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnRmlsZXNBZGRlZCcsIHRoaXMuZmlsZXNBZGRlZCwgdGhpcyApO1xuXHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnQmVmb3JlVXBsb2FkJywgdGhpcy5maWxlQmVmb3JlVXBsb2FkLCB0aGlzICk7XG5cdFx0dGhpcy51cGxvYWRlci51cGxvYWRlci51cGxvYWRlci5iaW5kKCdVcGxvYWRQcm9ncmVzcycsIHRoaXMuZmlsZVVwbG9hZFByb2dyZXNzLCB0aGlzICk7XG5cdFx0dGhpcy51cGxvYWRlci51cGxvYWRlci51cGxvYWRlci5iaW5kKCdGaWxlVXBsb2FkZWQnLCB0aGlzLmZpbGVVcGxvYWRlZCwgdGhpcyApO1xuXHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnZXJyb3InLCB0aGlzLmZpbGVVcGxvYWRFcnJvciwgdGhpcyApO1xuXHRcdHRoaXMucGFzdGVib2FyZC5yZW5kZXIoKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0ZmlsZXNBZGRlZDogZnVuY3Rpb24oIHVwbG9hZGVyLCBmaWxlcyApIHtcblx0XHQvL1xuXHRcdHRoaXMudG90YWwgPSBmaWxlcy5sZW5ndGg7XG5cdFx0dGhpcy5kb25lID0gMDtcblx0XHQvL19hY2Z1cGxvYWRlclxuXHRcdC8vdGhpcy5ub3RpY2UgPSBmYWxzZTtcblx0fSxcblx0ZmlsZUJlZm9yZVVwbG9hZDogZnVuY3Rpb24oIHVwbG9hZGVyLCBmaWxlICkge1xuXHRcdHRoaXMuYWRkUHJvZ3Jlc3MoKTtcblx0XHR0aGlzLnByb2dyZXNzLnNldExhYmVsKCBfLmVzY2FwZShmaWxlLm5hbWUpICk7XG5cdH0sXG5cdGZpbGVVcGxvYWRQcm9ncmVzczpmdW5jdGlvbiggdXBsb2FkZXIsIGZpbGUgKSB7XG5cdFx0dGhpcy5hZGRQcm9ncmVzcygpO1xuXHRcdHRoaXMucHJvZ3Jlc3Muc2V0UHJvZ3Jlc3MoICggMTAwICogdGhpcy5kb25lICsgZmlsZS5wZXJjZW50ICkgLyB0aGlzLnRvdGFsICk7XG5cdH0sXG5cdGZpbGVVcGxvYWRlZDpmdW5jdGlvbiggdXBsb2FkZXIsIGZpbGUsIHJlc3BvbnNlICkge1xuXHRcdGxldCByZXN1bHQ7XG5cdFx0dGhpcy5maWxlID0gZmlsZTtcblx0XHR0cnkge1xuXHRcdFx0dGhpcy50cmlnZ2VyKCdhY2YtZHJvcHpvbmUtdXBsb2FkZWQnLGZpbGUuYXR0YWNobWVudCx0aGlzLmRvbmUpO1xuXHRcdFx0dGhpcy5kb25lKys7XG5cdFx0XHRpZiAodGhpcy50b3RhbCA9PT0gdGhpcy5kb25lICkge1xuXHRcdFx0XHR0aGlzLnJlbW92ZVByb2dyZXNzKCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCggZXJyICkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0cmVzdWx0ID0gSlNPTi5wYXJzZSggcmVzcG9uc2UucmVzcG9uc2UgKTtcblx0XHRcdFx0dGhpcy5maWxlVXBsb2FkRXJyb3IoIHVwbG9hZGVyLCB7XG5cdFx0XHRcdFx0ZmlsZTogdGhpcy5maWxlLFxuXHRcdFx0XHRcdG1lc3NhZ2U6IHJlc3VsdC5kYXRhLm1lc3NhZ2Vcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGNhdGNoICggZXJyMiApIHtcblx0XHRcdFx0dGhpcy5maWxlVXBsb2FkRXJyb3IoIHVwbG9hZGVyLCB7XG5cdFx0XHRcdFx0ZmlsZTogdGhpcy5maWxlLFxuXHRcdFx0XHRcdG1lc3NhZ2U6IHJlc3BvbnNlLnJlc3BvbnNlXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0ZmlsZVVwbG9hZEVycm9yOmZ1bmN0aW9uKCB1cGxvYWRlciwgZXJyb3IgKSB7XG5cdFx0dGhpcy5kb25lKys7XG5cdFx0aWYgKHRoaXMudG90YWwgPT09IHRoaXMuZG9uZSApIHtcblx0XHRcdHRoaXMucmVtb3ZlUHJvZ3Jlc3MoKTtcblx0XHR9XG5cdFx0dGhpcy50cmlnZ2VyKCAnYWNmLWRyb3B6b25lLWVycm9yJywgZXJyb3IgKTtcblxuXHRcdHRoaXMuYWRkTm90aWNlKHtcblx0XHRcdHR5cGU6J2Vycm9yJyxcblx0XHRcdGJvbGQ6IF8uZXNjYXBlKGVycm9yLmZpbGUubmFtZSksXG5cdFx0XHRtZXNzYWdlOiBlcnJvci5tZXNzYWdlXG5cdFx0fSk7XG5cdH0sXG5cdGFkZFByb2dyZXNzOmZ1bmN0aW9uKCkge1xuXHRcdGlmICggdGhpcy5wcm9ncmVzcyApIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblx0XHR0aGlzLnByb2dyZXNzID0gbmV3IFByb2dyZXNzKCk7XG5cdFx0dGhpcy5wcm9ncmVzcy5yZW5kZXIoKS4kZWwucHJlcGVuZFRvKHRoaXMuZWwpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXHRyZW1vdmVQcm9ncmVzczpmdW5jdGlvbiggcGVyY2VudCApIHtcblx0XHRpZiAoICEgdGhpcy5wcm9ncmVzcyApIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblxuXHRcdHRoaXMucHJvZ3Jlc3MuJGVsLnJlbW92ZSgpO1xuXHRcdHRoaXMucHJvZ3Jlc3MgPSBmYWxzZTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0YWRkTm90aWNlOmZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLm5vdGljZSA9IG5ldyBOb3RpY2Uob3B0aW9ucyk7XG5cdFx0dGhpcy5ub3RpY2UucmVuZGVyKCk7XG5cdFx0dGhpcy5ub3RpY2UuJGVsLnByZXBlbmRUbyh0aGlzLmVsKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0cmVtb3ZlTm90aWNlOmZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRpZiAoICEhIHRoaXMubm90aWNlICkge1xuXHRcdFx0dGhpcy5ub3RpY2UucmVtb3ZlKCk7XG5cdFx0XHR0aGlzLm5vdGljZSA9IGZhbHNlO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fVxufSk7XG4iLCJcbm1vZHVsZS5leHBvcnRzID0gd3AubWVkaWEuVmlldy5leHRlbmQoe1xuXHR0ZW1wbGF0ZTp3cC50ZW1wbGF0ZSgnYWNmLWRyb3B6b25lLW5vdGljZScpLFxuXHRjbGFzc05hbWU6J25vdGljZSBpcy1kaXNtaXNzaWJsZScsXG5cdGV2ZW50czp7XG5cdFx0J2NsaWNrIC5ub3RpY2UtZGlzbWlzcycgOiAncmVtb3ZlJyxcblx0fSxcblx0cmVuZGVyOmZ1bmN0aW9uKCkge1xuXG5cdFx0d3AubWVkaWEuVmlldy5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtcblxuXHRcdHRoaXMuJGVsLmFkZENsYXNzKHRoaXMub3B0aW9ucy50eXBlKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG59KVxuIiwiXG5cbm1vZHVsZS5leHBvcnRzID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXHRldmVudHM6IHtcblx0XHRmb2N1czonbGlzdGVuUGFzdGUnLFxuXHRcdGJsdXI6J3N0b3BMaXN0ZW5QYXN0ZSdcblx0fSxcblx0bGlzdGVuUGFzdGU6ZnVuY3Rpb24oZSl7XG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0dGhpcy4kZWwub24oJ3Bhc3RlJyxmdW5jdGlvbigpIHtcblx0XHRcdHNlbGYub25QYXN0ZS5hcHBseSggc2VsZiwgYXJndW1lbnRzICk7XG5cdFx0fSk7XG5cdH0sXG5cdHN0b3BMaXN0ZW5QYXN0ZTpmdW5jdGlvbigpe1xuXHRcdHRoaXMuJGVsLm9mZigncGFzdGUnKTtcblx0fSxcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0KSB7XG5cdFx0QmFja2JvbmUuVmlldy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0dGhpcy5jb250cm9sbGVyID0gb3B0LmNvbnRyb2xsZXI7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gbWFrZSBmb2N1c3NhYmxlXG5cdFx0dGhpcy4kZWwuYXR0cigndGFiaW5kZXgnLCctMScpOy8vLmF0dHIoJ2NvbnRlbnRlZGl0YWJsZScsJ3RydWUnKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0b25QYXN0ZTpmdW5jdGlvbihlKXtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuXHRcdGNvbnN0IGl0ZW1zID0gZS5vcmlnaW5hbEV2ZW50LmNsaXBib2FyZERhdGEuaXRlbXM7XG5cdFx0bGV0IGksIGJsb2IsIGZpbGUsIGZpbGVuYW1lO1xuXG5cdFx0Zm9yICggaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKyApIHtcblxuXHRcdFx0aWYgKCBpdGVtc1tpXS5raW5kICE9PSAnZmlsZScgKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBnZXQgcGFzdGVkIGZpbGUgLi4uXG5cdFx0XHRibG9iID0gaXRlbXNbaV0uZ2V0QXNGaWxlKCk7XG5cdFx0XHRpZiAoICEhIGJsb2IgKSB7XG5cdFx0XHRcdC8vIC4uLiBhZGQgdG8gcGx1cGxvYWRcblxuXG5cdFx0XHRcdHRoaXMuY29udHJvbGxlci51cGxvYWRlci51cGxvYWRlci5wYXJhbSgncG9zdF9kYXRhJywge1xuXHRcdFx0XHRcdHBvc3RfdGl0bGU6IHdwLnRlbXBsYXRlKCdhY2YtZHJvcHpvbmUtYXR0YWNobWVudC10aXRsZScpKHtcblx0XHRcdFx0XHRcdGZpZWxkbmFtZTp0aGlzLmNvbnRyb2xsZXIuZmllbGQuZ2V0KCduYW1lJylcblx0XHRcdFx0XHR9KS50cmltKCksXG5cdFx0XHRcdFx0cG9zdF90eXBlOiAnYXR0YWNobWVudCdcblx0XHRcdFx0fSApO1xuXHRcdFx0XHR0aGlzLmNvbnRyb2xsZXIudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYWRkRmlsZSggYmxvYiwgYmxvYi5uYW1lICk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG59KTtcbiIsIlxubW9kdWxlLmV4cG9ydHMgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG5cdHRhZ05hbWU6ICAgJ2RpdicsXG5cdGNsYXNzTmFtZTogJ21lZGlhLXByb2dyZXNzLWJhci1ib3gnLFxuXHRyZW5kZXI6ZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy4kcHJvZ3Jlc3MgPSAkKCc8ZGl2IC8+JykuYWRkQ2xhc3MoJ21lZGlhLXByb2dyZXNzLWJhcicpO1xuXHRcdHRoaXMuJGxhYmVsID0gJCgnPGRpdiAvPicpLmFkZENsYXNzKCdtZWRpYS1wcm9ncmVzcy1sYWJlbCcpO1xuXHRcdHRoaXMuJGJhciA9ICQoJzxkaXYgLz4nKTtcblx0XHR0aGlzLiRlbFxuXHRcdFx0LmFwcGVuZCggdGhpcy4kbGFiZWwgKTtcblx0XHR0aGlzLiRwcm9ncmVzc1xuXHRcdFx0LmFwcGVuZCggdGhpcy4kYmFyIClcblx0XHRcdC5hcHBlbmRUbyggdGhpcy4kZWwgKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXHRzZXRMYWJlbDpmdW5jdGlvbihsYWJlbCkge1xuXHRcdHRoaXMuJGxhYmVsLnRleHQobGFiZWwpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXHRzZXRQcm9ncmVzczpmdW5jdGlvbiggcGVyY2VudCApIHtcblx0XHR0aGlzLiRiYXIud2lkdGgoICggcGVyY2VudCApKyclJyk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cbn0pO1xuIiwiXG5tb2R1bGUuZXhwb3J0cyA9IHdwLm1lZGlhLlZpZXcuZXh0ZW5kKHtcblx0dGFnTmFtZTogICAnZGl2Jyxcblx0Y2xhc3NOYW1lOiAnYWNmLWRyb3B6b25lLWluZm8nLFxuXHR0ZW1wbGF0ZTp3cC50ZW1wbGF0ZSgnYWNmLWRyb3B6b25lLWluZm8nKVxufSk7XG4iXX0=
