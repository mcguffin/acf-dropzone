!function(){"use strict";var e=wp.media.View.extend({tagName:"div",className:"acf-dropzone-info",template:wp.template("acf-dropzone-info")}),t=wp.media.View.extend({template:wp.template("acf-dropzone-notice"),className:"notice is-dismissible",events:{"click .notice-dismiss":"remove"},render:function(){return wp.media.View.prototype.render.apply(this,arguments),this.$el.addClass(this.options.type),this}}),i={};(function(e){(function(){var t;(t="undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null)&&t.__esModule,i=Backbone.View.extend({events:{focus:"listenPaste",blur:"stopListenPaste"},listenPaste:function(e){var t=this;this.$el.on("paste",function(){t.onPaste.apply(t,arguments)})},stopListenPaste:function(){this.$el.off("paste")},initialize:function(e){return Backbone.View.prototype.initialize.apply(this,arguments),this.controller=e.controller,this},render:function(){return this.$el.attr("tabindex","-1"),this},onPaste:function(e){e.preventDefault(),e.stopPropagation();var t,i,o=e.originalEvent.clipboardData.items;for(t=0;t<o.length;t++)"file"===o[t].kind&&(i=o[t].getAsFile())&&(this.controller.uploader.uploader.param("post_data",{post_title:wp.template("acf-dropzone-attachment-title")({fieldname:this.controller.field.get("name")}).trim(),post_type:"attachment"}),this.controller.uploader.uploader.uploader.addFile(i,i.name));return this}})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var o={};(function(e){(function(){var t,i=(t="undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null)&&t.__esModule?t:{default:t};o=Backbone.View.extend({tagName:"div",className:"media-progress-bar-box",render:function(){return this.$progress=(0,i.default)("<div />").addClass("media-progress-bar"),this.$label=(0,i.default)("<div />").addClass("media-progress-label"),this.$bar=(0,i.default)("<div />"),this.$el.append(this.$label),this.$progress.append(this.$bar).appendTo(this.$el),this},setLabel:function(e){return this.$label.text(e),this},setProgress:function(e){return this.$bar.width(e+"%"),this}})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var n={};(function(e){(function(){var r=l("undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null),d=l(t),s=l(i),a=l(o);function l(e){return e&&e.__esModule?e:{default:e}}n=Backbone.View.extend({initialize:function(e){return this.field=e.field,this.notice=!1,this.progress=!1,this.uploader=new wp.media.view.UploaderWindow({controller:this,uploader:{dropzone:this.el,container:this.el,params:{_acfuploader:this.field.get("key")}}}),this.pasteboard=new s.default({controller:this,el:this.$el.is('[data-uploader="wp"]')?this.el:this.field.$(".acf-gallery-attachments").get(0)}),this},render:function(){return(0,r.default)(this.uploader.render().el).appendTo(this.el),this.pasteboard.render(),this},ready:function(){var e=this;return this.$el.on("drop dragenter dragleave dragover",function(e){e.stopPropagation()}).on("drop",function(t){e.removeNotice()}),this.trigger("activate"),this.uploader.ready(),this.uploader.uploader.uploader.bind("FilesAdded",this.filesAdded,this),this.uploader.uploader.uploader.bind("BeforeUpload",this.fileBeforeUpload,this),this.uploader.uploader.uploader.bind("UploadProgress",this.fileUploadProgress,this),this.uploader.uploader.uploader.bind("FileUploaded",this.fileUploaded,this),this.uploader.uploader.uploader.bind("error",this.fileUploadError,this),this.pasteboard.render(),this},filesAdded:function(e,t){this.total=t.length,this.done=0},fileBeforeUpload:function(e,t){this.addProgress(),this.progress.setLabel(_.escape(t.name))},fileUploadProgress:function(e,t){this.addProgress(),this.progress.setProgress((100*this.done+t.percent)/this.total)},fileUploaded:function(e,t,i){var o;this.file=t;try{this.trigger("acf-dropzone-uploaded",t.attachment,this.done),this.done++,this.total===this.done&&this.removeProgress()}catch(n){try{o=JSON.parse(i.response),this.fileUploadError(e,{file:this.file,message:o.data.message})}catch(r){this.fileUploadError(e,{file:this.file,message:i.response})}}},fileUploadError:function(e,t){this.done++,this.total===this.done&&this.removeProgress(),this.trigger("acf-dropzone-error",t),this.addNotice({type:"error",bold:_.escape(t.file.name),message:t.message})},addProgress:function(){return this.progress?this:(this.progress=new a.default,this.progress.render().$el.prependTo(this.el),this)},removeProgress:function(e){return this.progress?(this.progress.$el.remove(),this.progress=!1,this):this},addNotice:function(e){return this.notice=new d.default(e),this.notice.render(),this.notice.$el.prependTo(this.el),this},removeNotice:function(e){return this.notice&&(this.notice.remove(),this.notice=!1),this}})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),function(t){(function(){r("undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null);var i=r(e),o=r(n);function r(e){return e&&e.__esModule?e:{default:e}}var d=function(e){var t,n,r,d;e.$el.is(".dropzone")&&(n=e.parent(),(t=e.$('[data-uploader="wp"]').get(0))&&(e.$(".hide-if-value>p").contents().filter(function(){return 3==this.nodeType}).remove(),(r=new i.default({or:!0})).render(),r.$el.prependTo(e.$(".hide-if-value")),(d=new o.default({el:t,field:e})).render(),d.ready(),d.on("acf-dropzone-uploaded",function(t,i){n&&"repeater"===n.get("type")&&i>0?e.append(t,n):e.render(t)})))},s=function(e){var t,n,r=e.$(".acf-gallery-attachments").get(0);e.$el.is(".dropzone")&&((n=new i.default({or:!1})).render(),n.$el.prependTo(r),(t=new o.default({el:r,field:e})).render(),t.ready(),t.on("acf-dropzone-uploaded",function(t){e.appendAttachment(t,"prepend"===e.get("insert")?0:void 0)}))};acf_dropzone.file_fields.forEach(function(e){acf.addAction("ready_field/type=".concat(e),d),acf.addAction("append_field/type=".concat(e),d)}),acf_dropzone.gallery_fields.forEach(function(e){acf.addAction("ready_field/type=".concat(e),s),acf.addAction("append_field/type=".concat(e),s)})}).call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2stZmxhdC9fcHJlbHVkZSIsInNyYy9qcy9saWIvdXBsb2FkZXItaW5mby5qcyIsInNyYy9qcy9saWIvbm90aWNlLmpzIiwic3JjL2pzL2xpYi9wYXN0ZWJvYXJkLmpzIiwic3JjL2pzL2xpYi9wcm9ncmVzcy5qcyIsInNyYy9qcy9saWIvYWNmLWRyb3B6b25lLmpzIiwic3JjL2pzL2FkbWluL2FjZi1kcm9wem9uZS9pbmRleC5qcyJdLCJuYW1lcyI6WyJfJHVwbG9hZGVySW5mb182Iiwid3AiLCJtZWRpYSIsIlZpZXciLCJleHRlbmQiLCJ0YWdOYW1lIiwiY2xhc3NOYW1lIiwidGVtcGxhdGUiLCJfJG5vdGljZV8zIiwiZXZlbnRzIiwiY2xpY2sgLm5vdGljZS1kaXNtaXNzIiwicmVuZGVyIiwicHJvdG90eXBlIiwiYXBwbHkiLCJ0aGlzIiwiYXJndW1lbnRzIiwiJGVsIiwiYWRkQ2xhc3MiLCJvcHRpb25zIiwidHlwZSIsIm9iaiIsIndpbmRvdyIsImpRdWVyeSIsImdsb2JhbCIsIl9fZXNNb2R1bGUiLCJfJHBhc3RlYm9hcmRfNCIsIkJhY2tib25lIiwiZm9jdXMiLCJibHVyIiwibGlzdGVuUGFzdGUiLCJlIiwic2VsZiIsIm9uIiwib25QYXN0ZSIsInN0b3BMaXN0ZW5QYXN0ZSIsIm9mZiIsImluaXRpYWxpemUiLCJvcHQiLCJjb250cm9sbGVyIiwiYXR0ciIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiaSIsImJsb2IiLCJpdGVtcyIsIm9yaWdpbmFsRXZlbnQiLCJjbGlwYm9hcmREYXRhIiwibGVuZ3RoIiwia2luZCIsImdldEFzRmlsZSIsInVwbG9hZGVyIiwicGFyYW0iLCJwb3N0X3RpdGxlIiwiZmllbGRuYW1lIiwiZmllbGQiLCJnZXQiLCJ0cmltIiwicG9zdF90eXBlIiwiYWRkRmlsZSIsIm5hbWUiLCJfanF1ZXJ5IiwiZGVmYXVsdCIsIl8kcHJvZ3Jlc3NfNSIsIiRwcm9ncmVzcyIsIiRsYWJlbCIsIiRiYXIiLCJhcHBlbmQiLCJhcHBlbmRUbyIsInNldExhYmVsIiwibGFiZWwiLCJ0ZXh0Iiwic2V0UHJvZ3Jlc3MiLCJwZXJjZW50Iiwid2lkdGgiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX25vdGljZSIsIl9wYXN0ZWJvYXJkIiwiX3Byb2dyZXNzIiwiXyRhY2ZEcm9wem9uZV8yIiwibm90aWNlIiwicHJvZ3Jlc3MiLCJ2aWV3IiwiVXBsb2FkZXJXaW5kb3ciLCJkcm9wem9uZSIsImVsIiwiY29udGFpbmVyIiwicGFyYW1zIiwiX2FjZnVwbG9hZGVyIiwicGFzdGVib2FyZCIsImlzIiwiJCIsInJlYWR5IiwicmVtb3ZlTm90aWNlIiwidHJpZ2dlciIsImJpbmQiLCJmaWxlc0FkZGVkIiwiZmlsZUJlZm9yZVVwbG9hZCIsImZpbGVVcGxvYWRQcm9ncmVzcyIsImZpbGVVcGxvYWRlZCIsImZpbGVVcGxvYWRFcnJvciIsImZpbGVzIiwidG90YWwiLCJkb25lIiwiZmlsZSIsImFkZFByb2dyZXNzIiwiXyIsImVzY2FwZSIsInJlc3BvbnNlIiwicmVzdWx0IiwiYXR0YWNobWVudCIsInJlbW92ZVByb2dyZXNzIiwiZXJyIiwiSlNPTiIsInBhcnNlIiwibWVzc2FnZSIsImRhdGEiLCJlcnIyIiwiZXJyb3IiLCJhZGROb3RpY2UiLCJib2xkIiwicHJlcGVuZFRvIiwicmVtb3ZlIiwiX3VwbG9hZGVySW5mbyIsIl9hY2ZEcm9wem9uZSIsImluaXRGaWxlRHJvcHpvbmUiLCJwYXJlbnQiLCJpbmZvIiwiY29udGVudHMiLCJmaWx0ZXIiLCJub2RlVHlwZSIsIm9yIiwiaW5pdEdhbGxlcnlEcm9wem9uZSIsImFwcGVuZEF0dGFjaG1lbnQiLCJhY2ZfZHJvcHpvbmUiLCJmaWxlX2ZpZWxkcyIsImZvckVhY2giLCJhY2YiLCJhZGRBY3Rpb24iLCJjb25jYXQiLCJnYWxsZXJ5X2ZpZWxkcyJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxhQ0FBLElBQUFBLEVBQWlCQyxHQUFHQyxNQUFNQyxL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Z0gsR0FDN0NLLElBQUlDLFVBQUoscUJBQUFDLE9BQW9DdkgsR0FBVWdILG1JTjNGL0MiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtcbiIsIlxubW9kdWxlLmV4cG9ydHMgPSB3cC5tZWRpYS5WaWV3LmV4dGVuZCh7XG5cdHRhZ05hbWU6ICAgJ2RpdicsXG5cdGNsYXNzTmFtZTogJ2FjZi1kcm9wem9uZS1pbmZvJyxcblx0dGVtcGxhdGU6d3AudGVtcGxhdGUoJ2FjZi1kcm9wem9uZS1pbmZvJylcbn0pO1xuIiwiXG5tb2R1bGUuZXhwb3J0cyA9IHdwLm1lZGlhLlZpZXcuZXh0ZW5kKHtcblx0dGVtcGxhdGU6d3AudGVtcGxhdGUoJ2FjZi1kcm9wem9uZS1ub3RpY2UnKSxcblx0Y2xhc3NOYW1lOidub3RpY2UgaXMtZGlzbWlzc2libGUnLFxuXHRldmVudHM6e1xuXHRcdCdjbGljayAubm90aWNlLWRpc21pc3MnIDogJ3JlbW92ZScsXG5cdH0sXG5cdHJlbmRlcjpmdW5jdGlvbigpIHtcblxuXHRcdHdwLm1lZGlhLlZpZXcucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XG5cblx0XHR0aGlzLiRlbC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMudHlwZSk7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fVxufSlcbiIsImltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5cbm1vZHVsZS5leHBvcnRzID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXHRldmVudHM6IHtcblx0XHRmb2N1czonbGlzdGVuUGFzdGUnLFxuXHRcdGJsdXI6J3N0b3BMaXN0ZW5QYXN0ZSdcblx0fSxcblx0bGlzdGVuUGFzdGU6ZnVuY3Rpb24oZSl7XG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0dGhpcy4kZWwub24oJ3Bhc3RlJyxmdW5jdGlvbigpIHtcblx0XHRcdHNlbGYub25QYXN0ZS5hcHBseSggc2VsZiwgYXJndW1lbnRzICk7XG5cdFx0fSk7XG5cdH0sXG5cdHN0b3BMaXN0ZW5QYXN0ZTpmdW5jdGlvbigpe1xuXHRcdHRoaXMuJGVsLm9mZigncGFzdGUnKTtcblx0fSxcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0KSB7XG5cdFx0QmFja2JvbmUuVmlldy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0dGhpcy5jb250cm9sbGVyID0gb3B0LmNvbnRyb2xsZXI7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gbWFrZSBmb2N1c3NhYmxlXG5cdFx0dGhpcy4kZWwuYXR0cigndGFiaW5kZXgnLCctMScpOy8vLmF0dHIoJ2NvbnRlbnRlZGl0YWJsZScsJ3RydWUnKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0b25QYXN0ZTpmdW5jdGlvbihlKXtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuXHRcdGNvbnN0IGl0ZW1zID0gZS5vcmlnaW5hbEV2ZW50LmNsaXBib2FyZERhdGEuaXRlbXM7XG5cdFx0bGV0IGksIGJsb2IsIGZpbGUsIGZpbGVuYW1lO1xuXG5cdFx0Zm9yICggaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKyApIHtcblxuXHRcdFx0aWYgKCBpdGVtc1tpXS5raW5kICE9PSAnZmlsZScgKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBnZXQgcGFzdGVkIGZpbGUgLi4uXG5cdFx0XHRibG9iID0gaXRlbXNbaV0uZ2V0QXNGaWxlKCk7XG5cdFx0XHRpZiAoICEhIGJsb2IgKSB7XG5cdFx0XHRcdC8vIC4uLiBhZGQgdG8gcGx1cGxvYWRcblxuXG5cdFx0XHRcdHRoaXMuY29udHJvbGxlci51cGxvYWRlci51cGxvYWRlci5wYXJhbSgncG9zdF9kYXRhJywge1xuXHRcdFx0XHRcdHBvc3RfdGl0bGU6IHdwLnRlbXBsYXRlKCdhY2YtZHJvcHpvbmUtYXR0YWNobWVudC10aXRsZScpKHtcblx0XHRcdFx0XHRcdGZpZWxkbmFtZTp0aGlzLmNvbnRyb2xsZXIuZmllbGQuZ2V0KCduYW1lJylcblx0XHRcdFx0XHR9KS50cmltKCksXG5cdFx0XHRcdFx0cG9zdF90eXBlOiAnYXR0YWNobWVudCdcblx0XHRcdFx0fSApO1xuXHRcdFx0XHR0aGlzLmNvbnRyb2xsZXIudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYWRkRmlsZSggYmxvYiwgYmxvYi5uYW1lICk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG59KTtcbiIsImltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5cbm1vZHVsZS5leHBvcnRzID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXHR0YWdOYW1lOiAgICdkaXYnLFxuXHRjbGFzc05hbWU6ICdtZWRpYS1wcm9ncmVzcy1iYXItYm94Jyxcblx0cmVuZGVyOmZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuJHByb2dyZXNzID0gJCgnPGRpdiAvPicpLmFkZENsYXNzKCdtZWRpYS1wcm9ncmVzcy1iYXInKTtcblx0XHR0aGlzLiRsYWJlbCA9ICQoJzxkaXYgLz4nKS5hZGRDbGFzcygnbWVkaWEtcHJvZ3Jlc3MtbGFiZWwnKTtcblx0XHR0aGlzLiRiYXIgPSAkKCc8ZGl2IC8+Jyk7XG5cdFx0dGhpcy4kZWxcblx0XHRcdC5hcHBlbmQoIHRoaXMuJGxhYmVsICk7XG5cdFx0dGhpcy4kcHJvZ3Jlc3Ncblx0XHRcdC5hcHBlbmQoIHRoaXMuJGJhciApXG5cdFx0XHQuYXBwZW5kVG8oIHRoaXMuJGVsICk7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0c2V0TGFiZWw6ZnVuY3Rpb24obGFiZWwpIHtcblx0XHR0aGlzLiRsYWJlbC50ZXh0KGxhYmVsKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0c2V0UHJvZ3Jlc3M6ZnVuY3Rpb24oIHBlcmNlbnQgKSB7XG5cdFx0dGhpcy4kYmFyLndpZHRoKCAoIHBlcmNlbnQgKSsnJScpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG59KTtcbiIsImltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5pbXBvcnQgTm90aWNlIGZyb20gJ25vdGljZS5qcyc7XG5pbXBvcnQgUGFzdGVib2FyZCBmcm9tICdwYXN0ZWJvYXJkLmpzJztcbmltcG9ydCBQcm9ncmVzcyBmcm9tICdwcm9ncmVzcy5qcyc7XG5cblxubW9kdWxlLmV4cG9ydHMgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKCBvcHQgKSB7XG5cblx0XHR0aGlzLmZpZWxkID0gb3B0LmZpZWxkO1xuXG5cdFx0dGhpcy5ub3RpY2UgPSBmYWxzZTtcblx0XHR0aGlzLnByb2dyZXNzID0gZmFsc2U7XG5cdFx0dGhpcy51cGxvYWRlciA9IG5ldyB3cC5tZWRpYS52aWV3LlVwbG9hZGVyV2luZG93KHtcblx0XHRcdGNvbnRyb2xsZXI6IHRoaXMsXG5cdFx0XHR1cGxvYWRlcjoge1xuXHRcdFx0XHRkcm9wem9uZTogIHRoaXMuZWwsXG5cdFx0XHRcdGNvbnRhaW5lcjogdGhpcy5lbCxcblx0XHRcdFx0cGFyYW1zOiB7XG5cdFx0XHRcdFx0X2FjZnVwbG9hZGVyOiB0aGlzLmZpZWxkLmdldCgna2V5JyksXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMucGFzdGVib2FyZCA9IG5ldyBQYXN0ZWJvYXJkKHtcblx0XHRcdGNvbnRyb2xsZXI6IHRoaXMsXG5cdFx0XHRlbDogdGhpcy4kZWwuaXMoJ1tkYXRhLXVwbG9hZGVyPVwid3BcIl0nKSA/IHRoaXMuZWwgOiB0aGlzLmZpZWxkLiQoJy5hY2YtZ2FsbGVyeS1hdHRhY2htZW50cycpLmdldCgwKVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cdHJlbmRlcjpmdW5jdGlvbigpIHtcblx0XHQkKCB0aGlzLnVwbG9hZGVyLnJlbmRlcigpLmVsICkuYXBwZW5kVG8oIHRoaXMuZWwgKTtcblxuXHRcdHRoaXMucGFzdGVib2FyZC5yZW5kZXIoKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXHRyZWFkeTogZnVuY3Rpb24oKSB7XG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0dGhpcy4kZWxcblx0XHQub24oJ2Ryb3AgZHJhZ2VudGVyIGRyYWdsZWF2ZSBkcmFnb3ZlcicsZnVuY3Rpb24oZSl7XG5cdFx0XHQvLyBwcmV2ZW50IGJsb2NrIGVkaXRvciBmaWxlIGRyb3Bcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKClcblx0XHR9KVxuXHRcdC5vbignZHJvcCcsZnVuY3Rpb24oZSl7XG5cdFx0XHQvLyByZXNldCBlcnJvclxuXHRcdFx0c2VsZi5yZW1vdmVOb3RpY2UoKTtcblx0XHR9KTtcblxuXHRcdHRoaXMudHJpZ2dlcignYWN0aXZhdGUnKVxuXHRcdHRoaXMudXBsb2FkZXIucmVhZHkoKTtcblx0XHQvL1xuXHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnRmlsZXNBZGRlZCcsIHRoaXMuZmlsZXNBZGRlZCwgdGhpcyApO1xuXHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnQmVmb3JlVXBsb2FkJywgdGhpcy5maWxlQmVmb3JlVXBsb2FkLCB0aGlzICk7XG5cdFx0dGhpcy51cGxvYWRlci51cGxvYWRlci51cGxvYWRlci5iaW5kKCdVcGxvYWRQcm9ncmVzcycsIHRoaXMuZmlsZVVwbG9hZFByb2dyZXNzLCB0aGlzICk7XG5cdFx0dGhpcy51cGxvYWRlci51cGxvYWRlci51cGxvYWRlci5iaW5kKCdGaWxlVXBsb2FkZWQnLCB0aGlzLmZpbGVVcGxvYWRlZCwgdGhpcyApO1xuXHRcdHRoaXMudXBsb2FkZXIudXBsb2FkZXIudXBsb2FkZXIuYmluZCgnZXJyb3InLCB0aGlzLmZpbGVVcGxvYWRFcnJvciwgdGhpcyApO1xuXHRcdHRoaXMucGFzdGVib2FyZC5yZW5kZXIoKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0ZmlsZXNBZGRlZDogZnVuY3Rpb24oIHVwbG9hZGVyLCBmaWxlcyApIHtcblx0XHQvL1xuXHRcdHRoaXMudG90YWwgPSBmaWxlcy5sZW5ndGg7XG5cdFx0dGhpcy5kb25lID0gMDtcblx0XHQvL19hY2Z1cGxvYWRlclxuXHRcdC8vdGhpcy5ub3RpY2UgPSBmYWxzZTtcblx0fSxcblx0ZmlsZUJlZm9yZVVwbG9hZDogZnVuY3Rpb24oIHVwbG9hZGVyLCBmaWxlICkge1xuXHRcdHRoaXMuYWRkUHJvZ3Jlc3MoKTtcblx0XHR0aGlzLnByb2dyZXNzLnNldExhYmVsKCBfLmVzY2FwZShmaWxlLm5hbWUpICk7XG5cdH0sXG5cdGZpbGVVcGxvYWRQcm9ncmVzczpmdW5jdGlvbiggdXBsb2FkZXIsIGZpbGUgKSB7XG5cdFx0dGhpcy5hZGRQcm9ncmVzcygpO1xuXHRcdHRoaXMucHJvZ3Jlc3Muc2V0UHJvZ3Jlc3MoICggMTAwICogdGhpcy5kb25lICsgZmlsZS5wZXJjZW50ICkgLyB0aGlzLnRvdGFsICk7XG5cdH0sXG5cdGZpbGVVcGxvYWRlZDpmdW5jdGlvbiggdXBsb2FkZXIsIGZpbGUsIHJlc3BvbnNlICkge1xuXHRcdGxldCByZXN1bHQ7XG5cdFx0dGhpcy5maWxlID0gZmlsZTtcblx0XHR0cnkge1xuXHRcdFx0dGhpcy50cmlnZ2VyKCdhY2YtZHJvcHpvbmUtdXBsb2FkZWQnLGZpbGUuYXR0YWNobWVudCx0aGlzLmRvbmUpO1xuXHRcdFx0dGhpcy5kb25lKys7XG5cdFx0XHRpZiAodGhpcy50b3RhbCA9PT0gdGhpcy5kb25lICkge1xuXHRcdFx0XHR0aGlzLnJlbW92ZVByb2dyZXNzKCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCggZXJyICkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0cmVzdWx0ID0gSlNPTi5wYXJzZSggcmVzcG9uc2UucmVzcG9uc2UgKTtcblx0XHRcdFx0dGhpcy5maWxlVXBsb2FkRXJyb3IoIHVwbG9hZGVyLCB7XG5cdFx0XHRcdFx0ZmlsZTogdGhpcy5maWxlLFxuXHRcdFx0XHRcdG1lc3NhZ2U6IHJlc3VsdC5kYXRhLm1lc3NhZ2Vcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGNhdGNoICggZXJyMiApIHtcblx0XHRcdFx0dGhpcy5maWxlVXBsb2FkRXJyb3IoIHVwbG9hZGVyLCB7XG5cdFx0XHRcdFx0ZmlsZTogdGhpcy5maWxlLFxuXHRcdFx0XHRcdG1lc3NhZ2U6IHJlc3BvbnNlLnJlc3BvbnNlXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0ZmlsZVVwbG9hZEVycm9yOmZ1bmN0aW9uKCB1cGxvYWRlciwgZXJyb3IgKSB7XG5cdFx0dGhpcy5kb25lKys7XG5cdFx0aWYgKHRoaXMudG90YWwgPT09IHRoaXMuZG9uZSApIHtcblx0XHRcdHRoaXMucmVtb3ZlUHJvZ3Jlc3MoKTtcblx0XHR9XG5cdFx0dGhpcy50cmlnZ2VyKCAnYWNmLWRyb3B6b25lLWVycm9yJywgZXJyb3IgKTtcblxuXHRcdHRoaXMuYWRkTm90aWNlKHtcblx0XHRcdHR5cGU6J2Vycm9yJyxcblx0XHRcdGJvbGQ6IF8uZXNjYXBlKGVycm9yLmZpbGUubmFtZSksXG5cdFx0XHRtZXNzYWdlOiBlcnJvci5tZXNzYWdlXG5cdFx0fSk7XG5cdH0sXG5cdGFkZFByb2dyZXNzOmZ1bmN0aW9uKCkge1xuXHRcdGlmICggdGhpcy5wcm9ncmVzcyApIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblx0XHR0aGlzLnByb2dyZXNzID0gbmV3IFByb2dyZXNzKCk7XG5cdFx0dGhpcy5wcm9ncmVzcy5yZW5kZXIoKS4kZWwucHJlcGVuZFRvKHRoaXMuZWwpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXHRyZW1vdmVQcm9ncmVzczpmdW5jdGlvbiggcGVyY2VudCApIHtcblx0XHRpZiAoICEgdGhpcy5wcm9ncmVzcyApIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblxuXHRcdHRoaXMucHJvZ3Jlc3MuJGVsLnJlbW92ZSgpO1xuXHRcdHRoaXMucHJvZ3Jlc3MgPSBmYWxzZTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0YWRkTm90aWNlOmZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLm5vdGljZSA9IG5ldyBOb3RpY2Uob3B0aW9ucyk7XG5cdFx0dGhpcy5ub3RpY2UucmVuZGVyKCk7XG5cdFx0dGhpcy5ub3RpY2UuJGVsLnByZXBlbmRUbyh0aGlzLmVsKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblx0cmVtb3ZlTm90aWNlOmZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRpZiAoICEhIHRoaXMubm90aWNlICkge1xuXHRcdFx0dGhpcy5ub3RpY2UucmVtb3ZlKCk7XG5cdFx0XHR0aGlzLm5vdGljZSA9IGZhbHNlO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fVxufSk7XG4iLCJpbXBvcnQgJCBmcm9tICdqcXVlcnknO1xuaW1wb3J0IFVwbG9hZGVySW5mbyBmcm9tICd1cGxvYWRlci1pbmZvLmpzJztcbmltcG9ydCBBQ0ZEcm9wem9uZSBmcm9tICdhY2YtZHJvcHpvbmUuanMnO1xuXG5cblxuY29uc3QgaW5pdEZpbGVEcm9wem9uZSA9IGZpZWxkID0+IHtcblx0bGV0IGVsLFxuXHRcdHVwbG9hZGVyVHlwZSxcblx0XHRwYXJlbnQsXG5cdFx0aW5mbyxcblx0XHRkcm9wem9uZTtcblxuXHRpZiAoICEgZmllbGQuJGVsLmlzKCcuZHJvcHpvbmUnKSApIHtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRwYXJlbnQgPSBmaWVsZC5wYXJlbnQoKTtcblxuXHRlbCA9IGZpZWxkLiQoJ1tkYXRhLXVwbG9hZGVyPVwid3BcIl0nKS5nZXQoMClcblxuXHRpZiAoICEgZWwgKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTU3MTA3Ni9yZW1vdmUtdGV4dC13aXRoLWpxdWVyeVxuXHRmaWVsZC4kKCcuaGlkZS1pZi12YWx1ZT5wJylcblx0XHQuY29udGVudHMoKVxuXHRcdC5maWx0ZXIoIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMubm9kZVR5cGUgPT0gMzsgLy9Ob2RlLlRFWFRfTk9ERVxuXHRcdH0pXG5cdFx0LnJlbW92ZSgpO1xuXG5cdGluZm8gPSBuZXcgVXBsb2FkZXJJbmZvKHtvcjp0cnVlfSk7XG5cdGluZm8ucmVuZGVyKCk7XG5cdGluZm8uJGVsLnByZXBlbmRUbyggZmllbGQuJCgnLmhpZGUtaWYtdmFsdWUnKSApO1xuXG5cblx0ZHJvcHpvbmUgPSBuZXcgQUNGRHJvcHpvbmUoe1xuXHRcdGVsOiBlbCxcblx0XHRmaWVsZDogZmllbGRcblx0fSk7XG5cdGRyb3B6b25lLnJlbmRlcigpO1xuXHRkcm9wem9uZS5yZWFkeSgpO1xuXHRkcm9wem9uZS5vbignYWNmLWRyb3B6b25lLXVwbG9hZGVkJywgKCBhdHRhY2htZW50LCBpICkgPT4ge1xuXHRcdGlmICggcGFyZW50ICYmIHBhcmVudC5nZXQoJ3R5cGUnKSA9PT0gJ3JlcGVhdGVyJyAmJiBpID4gMCApIHtcblx0XHRcdGZpZWxkLmFwcGVuZCggYXR0YWNobWVudCwgcGFyZW50ICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGZpZWxkLnJlbmRlcihhdHRhY2htZW50KTtcblx0XHR9XG5cdH0pO1xuXG5cbn1cbmNvbnN0IGluaXRHYWxsZXJ5RHJvcHpvbmUgPSBmaWVsZCA9PiB7XG5cblx0bGV0IGRyb3B6b25lLFxuXHRcdGluZm8sXG5cdFx0ZWwgPSBmaWVsZC4kKCcuYWNmLWdhbGxlcnktYXR0YWNobWVudHMnKS5nZXQoMCk7XG5cblx0aWYgKCAhIGZpZWxkLiRlbC5pcygnLmRyb3B6b25lJykgKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0aW5mbyA9IG5ldyBVcGxvYWRlckluZm8oe29yOmZhbHNlfSk7XG5cdGluZm8ucmVuZGVyKCk7XG5cdGluZm8uJGVsLnByZXBlbmRUbyggZWwgKTtcblxuXHRkcm9wem9uZSA9IG5ldyBBQ0ZEcm9wem9uZSh7XG5cdFx0ZWw6IGVsLFxuXHRcdGZpZWxkOiBmaWVsZFxuXHR9KTtcblx0ZHJvcHpvbmUucmVuZGVyKCk7XG5cdGRyb3B6b25lLnJlYWR5KCk7XG5cdGRyb3B6b25lLm9uKCdhY2YtZHJvcHpvbmUtdXBsb2FkZWQnLCBhdHRhY2htZW50ID0+IHtcblxuXHRcdGZpZWxkLmFwcGVuZEF0dGFjaG1lbnQoXG5cdFx0XHRhdHRhY2htZW50LFxuXHRcdFx0ZmllbGQuZ2V0KCdpbnNlcnQnKSA9PT0gJ3ByZXBlbmQnID8gMCA6IHVuZGVmaW5lZFxuXHRcdCk7XG5cblx0fSk7XG59XG5cbmFjZl9kcm9wem9uZS5maWxlX2ZpZWxkcy5mb3JFYWNoKCB0eXBlID0+IHtcblx0YWNmLmFkZEFjdGlvbiggYHJlYWR5X2ZpZWxkL3R5cGU9JHt0eXBlfWAsICAgaW5pdEZpbGVEcm9wem9uZSApO1xuXHRhY2YuYWRkQWN0aW9uKCBgYXBwZW5kX2ZpZWxkL3R5cGU9JHt0eXBlfWAsICAgaW5pdEZpbGVEcm9wem9uZSApO1xufSk7XG5cbmFjZl9kcm9wem9uZS5nYWxsZXJ5X2ZpZWxkcy5mb3JFYWNoKCB0eXBlID0+IHtcblx0YWNmLmFkZEFjdGlvbiggYHJlYWR5X2ZpZWxkL3R5cGU9JHt0eXBlfWAsICAgaW5pdEdhbGxlcnlEcm9wem9uZSApO1xuXHRhY2YuYWRkQWN0aW9uKCBgYXBwZW5kX2ZpZWxkL3R5cGU9JHt0eXBlfWAsICAgaW5pdEdhbGxlcnlEcm9wem9uZSApO1xufSk7XG4iXX0=